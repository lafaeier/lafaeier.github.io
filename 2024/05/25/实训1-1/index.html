<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>实训1-1 | Hephaestus</title><meta name="author" content="surtr lafael"><meta name="copyright" content="surtr lafael"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="接下来是Qt部分，基本的内容已经实现，目前欠缺的是可视化等一些用于用户操作的内容。 该文件中我会逐个写入代码，后续可能增加修改或演示等 widgetwidget.h#ifndef WIDGET_H#define WIDGET_H#include &lt;QLabel&gt;#include &lt;QWidget&gt;#include &lt;QPushButton&gt;#include &amp;l">
<meta property="og:type" content="article">
<meta property="og:title" content="实训1-1">
<meta property="og:url" content="https://www.lafael.top/2024/05/25/%E5%AE%9E%E8%AE%AD1-1/index.html">
<meta property="og:site_name" content="Hephaestus">
<meta property="og:description" content="接下来是Qt部分，基本的内容已经实现，目前欠缺的是可视化等一些用于用户操作的内容。 该文件中我会逐个写入代码，后续可能增加修改或演示等 widgetwidget.h#ifndef WIDGET_H#define WIDGET_H#include &lt;QLabel&gt;#include &lt;QWidget&gt;#include &lt;QPushButton&gt;#include &amp;l">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/832c7ac5ccce17309c24a1ae9c06c3e6.jpg">
<meta property="article:published_time" content="2024-05-25T08:14:15.000Z">
<meta property="article:modified_time" content="2024-07-07T11:07:01.094Z">
<meta property="article:author" content="surtr lafael">
<meta property="article:tag" content="c++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/832c7ac5ccce17309c24a1ae9c06c3e6.jpg"><link rel="shortcut icon" href="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/微信图片_20240324121443.jpg"><link rel="canonical" href="https://www.lafael.top/2024/05/25/%E5%AE%9E%E8%AE%AD1-1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":300,"languages":{"author":"作者: surtr lafael","link":"链接: ","source":"来源: Hephaestus","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '实训1-1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-07 19:07:01'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/lafaeier/PicBed/image/img/832c7ac5ccce17309c24a1ae9c06c3e6.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Hephaestus"><span class="site-name">Hephaestus</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">实训1-1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-05-25T08:14:15.000Z" title="发表于 2024-05-25 16:14:15">2024-05-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-07T11:07:01.094Z" title="更新于 2024-07-07 19:07:01">2024-07-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E8%AE%AD/">实训</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>65分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="实训1-1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>接下来是Qt部分，基本的内容已经实现，目前欠缺的是可视化等一些用于用户操作的内容。</p>
<p>该文件中我会逐个写入代码，后续可能增加修改或演示等</p>
<h1 id="widget"><a href="#widget" class="headerlink" title="widget"></a>widget</h1><h2 id="widget-h"><a href="#widget-h" class="headerlink" title="widget.h"></a>widget.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WIDGET_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStackedWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"></span><br><span class="line">QT_BEGIN_NAMESPACE</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Widget</span>;</span><br><span class="line">&#125;</span><br><span class="line">QT_END_NAMESPACE</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Widget</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Widget</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">Widget</span>();</span><br><span class="line">    <span class="type">static</span>  std::vector&lt;QString&gt; nowUser;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">resizeEvent</span><span class="params">(QResizeEvent *event)</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Widget *ui;</span><br><span class="line">    QLabel *backgroundLabel;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<h2 id="widget-cpp"><a href="#widget-cpp" class="headerlink" title="widget.cpp"></a>widget.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;./ui_widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStackedWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="comment">// #include &quot;base.h&quot;</span></span><br><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::Widget)</span><br><span class="line"><span class="comment">// , base(nullptr)</span></span><br><span class="line"><span class="comment">// , stack(new QStackedWidget)</span></span><br><span class="line">&#123;</span><br><span class="line">    backgroundLabel=(<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>));</span><br><span class="line">    <span class="comment">// 设置布局</span></span><br><span class="line">    <span class="built_in">setMaximumSize</span>(<span class="number">1800</span>,<span class="number">1200</span>);</span><br><span class="line">    <span class="built_in">setMinimumSize</span>(<span class="number">1200</span>,<span class="number">900</span>);</span><br><span class="line">    <span class="comment">// 加载并设置背景图片</span></span><br><span class="line">    <span class="function">QPixmap <span class="title">backgroundPixmap</span><span class="params">(<span class="string">&quot;:/image/tree.png&quot;</span>)</span></span>;</span><br><span class="line">    backgroundLabel-&gt;<span class="built_in">setPixmap</span>(backgroundPixmap);</span><br><span class="line">    backgroundLabel-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载背景图片</span></span><br><span class="line">    <span class="comment">// QPixmap image();</span></span><br><span class="line">    <span class="comment">// // resize(1800,1200);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 设置背景图片</span></span><br><span class="line">    <span class="comment">// QPalette palette;</span></span><br><span class="line">    <span class="comment">// palette.setBrush(this-&gt;backgroundRole(), QBrush(image));</span></span><br><span class="line">    <span class="comment">// this-&gt;setPalette(palette);</span></span><br><span class="line">    <span class="comment">// this-&gt;setAutoFillBackground(true);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Widget::~<span class="built_in">Widget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// if(stack!=nullptr)</span></span><br><span class="line">    <span class="comment">//     delete stack;</span></span><br><span class="line">    <span class="comment">// stack=nullptr;</span></span><br><span class="line">    <span class="keyword">if</span>(ui!=<span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">delete</span> ui;</span><br><span class="line">    ui=<span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::resizeEvent</span><span class="params">(QResizeEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QWidget::<span class="built_in">resizeEvent</span>(event);</span><br><span class="line">    backgroundLabel-&gt;<span class="built_in">resize</span>(<span class="built_in">size</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::vector&lt;QString&gt; Widget::nowUser=std::<span class="built_in">vector</span>&lt;QString&gt;(<span class="number">6</span>)=&#123;<span class="string">&quot;Null&quot;</span>,<span class="string">&quot;XXX&quot;</span>,<span class="string">&quot;0&quot;</span>,<span class="string">&quot;NNNNNN&quot;</span>,<span class="string">&quot;0&quot;</span>&#125;;</span><br><span class="line"><span class="comment">//名称，密码，通过挑战地图情况，六关通过情况，用时多少,积分</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在这个类中，主要搭载了所有界面的背景板，后续如果你有需求，也可以在里面加入音乐播放器。<br><img src="\img\image-20240525162605473.png" alt="image-20240525162605473" style="zoom:80%;" /><br>目前效果如上（背景板）</p>
<h1 id="initial"><a href="#initial" class="headerlink" title="initial"></a>initial</h1><h2 id="initial-h"><a href="#initial-h" class="headerlink" title="initial.h"></a>initial.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> INITIAL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INITIAL_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLineEdit&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGridLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStackedWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextStream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;start.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">initial</span>:<span class="keyword">public</span> Widget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">initial</span>(Widget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">initial</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">turnOut</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//退出</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">goIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//进入登录</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">store</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//存储的开始</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    start* Start;</span><br><span class="line">    QStackedWidget *stack;</span><br><span class="line">    QVBoxLayout* menu;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// INITIAL_H</span></span></span><br></pre></td></tr></table></figure>
<h2 id="initial-cpp"><a href="#initial-cpp" class="headerlink" title="initial.cpp"></a>initial.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;initial.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">initial::<span class="built_in">initial</span>(Widget *parent)</span><br><span class="line">    :<span class="built_in">Widget</span>(parent)</span><br><span class="line">    ,<span class="built_in">stack</span>(<span class="keyword">new</span> QStackedWidget)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    QLabel *tital=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    QPixmap _map1(<span class="string">&quot;:/image/title.png&quot;</span>);</span><br><span class="line">    tital-&gt;<span class="built_in">setPixmap</span>(_map1);</span><br><span class="line">    tital-&gt;<span class="built_in">setFixedSize</span>(<span class="number">800</span>,<span class="number">400</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// QLabel *pixs=new QLabel(this);</span></span><br><span class="line">    <span class="comment">// QPixmap _map2(&quot;:/image/meishuzi.png&quot;);</span></span><br><span class="line">    <span class="comment">// tital-&gt;setPixmap(_map2);</span></span><br><span class="line">    <span class="comment">// tital-&gt;setFixedSize(50,70);</span></span><br><span class="line"></span><br><span class="line">    QWidget* startIn=<span class="keyword">new</span> <span class="built_in">QWidget</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QGridLayout* allIn =<span class="keyword">new</span> <span class="built_in">QGridLayout</span>(startIn);</span><br><span class="line">    allIn-&gt;<span class="built_in">setHorizontalSpacing</span>(<span class="number">300</span>);</span><br><span class="line">    allIn-&gt;<span class="built_in">setVerticalSpacing</span>(<span class="number">100</span>);</span><br><span class="line">    allIn-&gt;<span class="built_in">setSizeConstraint</span>(QLayout::SetFixedSize);</span><br><span class="line"></span><br><span class="line">    QPushButton* startL=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;开始游戏&quot;</span>,startIn);</span><br><span class="line">    QPushButton* out=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;退出&quot;</span>,startIn);</span><br><span class="line">    out-&gt;<span class="built_in">setStyleSheet</span>(</span><br><span class="line">        <span class="string">&quot;QPushButton &#123; background-color: lightgray; &#125;&quot;</span></span><br><span class="line">        <span class="string">&quot;QPushButton:hover &#123; background-color: yellow; &#125;&quot;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    startL-&gt;<span class="built_in">setFixedSize</span>(<span class="number">480</span>,<span class="number">120</span>);</span><br><span class="line">    out-&gt;<span class="built_in">setFixedSize</span>(<span class="number">480</span>,<span class="number">120</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// allIn-&gt;addWidget(pixs,0,0);</span></span><br><span class="line">    allIn-&gt;<span class="built_in">addWidget</span>(tital,<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    allIn-&gt;<span class="built_in">addWidget</span>(startL,<span class="number">5</span>,<span class="number">13</span>);</span><br><span class="line">    allIn-&gt;<span class="built_in">addWidget</span>(out,<span class="number">12</span>,<span class="number">13</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// QHBoxLayout* _menu=new QHBoxLayout(this);</span></span><br><span class="line">    <span class="comment">// menu=new QVBoxLayout();</span></span><br><span class="line">    <span class="comment">// menu-&gt;addStretch();</span></span><br><span class="line">    <span class="comment">// menu-&gt;addWidget(startIn);</span></span><br><span class="line">    <span class="comment">// _menu-&gt;addLayout(menu);</span></span><br><span class="line"></span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    Start=<span class="keyword">new</span> <span class="built_in">start</span>(stack,<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(Start);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(out,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;initial::turnOut);</span><br><span class="line">    <span class="built_in">connect</span>(startL,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;initial::goIn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">initial::~<span class="built_in">initial</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> menu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initial::turnOut</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QCoreApplication::<span class="built_in">quit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initial::goIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Start);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initial::store</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Start-&gt;<span class="built_in">preStore</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h2><p>这里搭建的是开始页面，包含一个主题图标和两个按钮，分别为开始和退出。作为未优化的版本，看起来或许会不顺眼。</p>
<p><img src="\img\image-20240525162605473.png" alt="image-20240525162605473" style="zoom:80%;" /></p>
<p>点击退出就退出，点击开始进入下一个界面</p>
<h1 id="start"><a href="#start" class="headerlink" title="start"></a>start</h1><h2 id="start-h"><a href="#start-h" class="headerlink" title="start.h"></a>start.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> START_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> START_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLineEdit&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGridLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextStream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStackedWidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;game.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">start</span>:<span class="keyword">public</span> Widget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">start</span>(QStackedWidget *,Widget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">start</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">signIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//登录</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">subscribe</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//注册</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//写入账号</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">creaIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//创建账号</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">hideShow</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//密码是否可见</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">nullIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//虚空登入</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readLog</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//读取文件</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">writeLog</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//写入文件</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">preStore</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//接收写入信号</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QStackedWidget *stack;</span><br><span class="line">    game *Game;</span><br><span class="line">    QLineEdit *account;</span><br><span class="line">    QLineEdit *password;</span><br><span class="line">    QPushButton *logIn;</span><br><span class="line">    QPushButton *registe;</span><br><span class="line">    QPushButton *finishRead;</span><br><span class="line">    QPushButton *finishCrea;</span><br><span class="line">    QPushButton *look;</span><br><span class="line">    QPushButton *toReturn;</span><br><span class="line">    QPushButton *nullLog;</span><br><span class="line">    <span class="type">bool</span> state;</span><br><span class="line">    <span class="type">int</span> max;</span><br><span class="line">    <span class="comment">//从1开始</span></span><br><span class="line">    <span class="type">int</span> now;</span><br><span class="line">    <span class="comment">//从0开始</span></span><br><span class="line">    <span class="type">bool</span> out;</span><br><span class="line">    std::vector&lt;std::vector&lt;QString&gt;&gt; users;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// START_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="start-cpp"><a href="#start-cpp" class="headerlink" title="start.cpp"></a>start.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;start.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">start::<span class="built_in">start</span>(QStackedWidget* s,Widget *parent)</span><br><span class="line">    :<span class="built_in">Widget</span>(parent)</span><br><span class="line">    ,<span class="built_in">stack</span>(s)</span><br><span class="line">    ,<span class="built_in">state</span>(<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">    out=<span class="literal">true</span>;</span><br><span class="line">    stack=s;</span><br><span class="line">    QWidget *useWidget=<span class="keyword">new</span> <span class="built_in">QWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//窗口小部件</span></span><br><span class="line">    account = <span class="keyword">new</span> <span class="built_in">QLineEdit</span>(useWidget);</span><br><span class="line">    account-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    password = <span class="keyword">new</span> <span class="built_in">QLineEdit</span>(useWidget);</span><br><span class="line">    password-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;点击登录以登入&quot;</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;点击注册以注册账户...&quot;</span>);</span><br><span class="line">    account-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">true</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">true</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setEchoMode</span>(QLineEdit::Password);</span><br><span class="line">    <span class="comment">// account-&gt;setsi</span></span><br><span class="line">    <span class="comment">// 创建文本框</span></span><br><span class="line"></span><br><span class="line">    logIn=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;登录&quot;</span>,useWidget);</span><br><span class="line">    registe=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;注册&quot;</span>,useWidget);</span><br><span class="line">    finishRead=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;完成&quot;</span>,useWidget);</span><br><span class="line">    finishRead-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    finishCrea=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;完成&quot;</span>,useWidget);</span><br><span class="line">    finishCrea-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    look=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;显示&quot;</span>,useWidget);</span><br><span class="line">    look-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    toReturn=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>,useWidget);</span><br><span class="line">    toReturn-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    nullLog=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;游客模式&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//构建按钮</span></span><br><span class="line"></span><br><span class="line">    logIn-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    registe-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    finishRead-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    finishCrea-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    look-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    toReturn-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    account-&gt;<span class="built_in">setFixedSize</span>(<span class="number">480</span>,<span class="number">40</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setFixedSize</span>(<span class="number">480</span>,<span class="number">40</span>);</span><br><span class="line">    nullLog-&gt;<span class="built_in">setFixedSize</span>(<span class="number">240</span>,<span class="number">80</span>);</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    QGridLayout *menu=<span class="keyword">new</span> <span class="built_in">QGridLayout</span>(useWidget);</span><br><span class="line">    menu-&gt;<span class="built_in">setHorizontalSpacing</span>(<span class="number">100</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">setVerticalSpacing</span>(<span class="number">100</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">setSizeConstraint</span>(QLayout::SetFixedSize);</span><br><span class="line">    QHBoxLayout *total=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    total-&gt;<span class="built_in">addWidget</span>(useWidget);</span><br><span class="line">    <span class="comment">// useWidget-&gt;setAlignment(Qt::AlignCenter | Qt::AlignBottom);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建布局并将文本框添加到布局中</span></span><br><span class="line"></span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(account,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(logIn,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(password,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(registe,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(finishRead,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(finishCrea,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(look,<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(toReturn,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(nullLog,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    Game=<span class="keyword">new</span> <span class="built_in">game</span>(stack,<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(Game);</span><br><span class="line">    stack-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(logIn,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::signIn);</span><br><span class="line">    <span class="built_in">connect</span>(registe,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::subscribe);</span><br><span class="line">    <span class="built_in">connect</span>(toReturn,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::reIn);</span><br><span class="line">    <span class="built_in">connect</span>(finishRead,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::readIn);</span><br><span class="line">    <span class="built_in">connect</span>(finishCrea,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::creaIn);</span><br><span class="line">    <span class="built_in">connect</span>(look,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::hideShow);</span><br><span class="line">    <span class="built_in">connect</span>(nullLog,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;start::nullIn);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">readLog</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">start::~<span class="built_in">start</span>()&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::signIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    account-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">false</span>);</span><br><span class="line">    account-&gt;<span class="built_in">show</span>();</span><br><span class="line">    password-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">false</span>);</span><br><span class="line">    password-&gt;<span class="built_in">show</span>();</span><br><span class="line">    nullLog-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;输入账号...&quot;</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;输入密码...&quot;</span>);</span><br><span class="line">    logIn-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    registe-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    finishRead-&gt;<span class="built_in">show</span>();</span><br><span class="line">    look-&gt;<span class="built_in">show</span>();</span><br><span class="line">    toReturn-&gt;<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::subscribe</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    account-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">false</span>);</span><br><span class="line">    account-&gt;<span class="built_in">show</span>();</span><br><span class="line">    password-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">false</span>);</span><br><span class="line">    password-&gt;<span class="built_in">show</span>();</span><br><span class="line">    nullLog-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;输入账号...&quot;</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;输入密码...&quot;</span>);</span><br><span class="line">    logIn-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    registe-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    finishCrea-&gt;<span class="built_in">show</span>();</span><br><span class="line">    look-&gt;<span class="built_in">show</span>();</span><br><span class="line">    toReturn-&gt;<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::reIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    state=<span class="literal">true</span>;</span><br><span class="line">    account-&gt;<span class="built_in">clear</span>();</span><br><span class="line">    password-&gt;<span class="built_in">clear</span>();</span><br><span class="line">    password-&gt;<span class="built_in">setEchoMode</span>(QLineEdit::Password);</span><br><span class="line">    account-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">true</span>);</span><br><span class="line">    account-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    password-&gt;<span class="built_in">setReadOnly</span>(<span class="literal">true</span>);</span><br><span class="line">    password-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    nullLog-&gt;<span class="built_in">show</span>();</span><br><span class="line">    account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;点击登录以登入...&quot;</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;点击注册以注册账户...&quot;</span>);</span><br><span class="line">    logIn-&gt;<span class="built_in">show</span>();</span><br><span class="line">    registe-&gt;<span class="built_in">show</span>();</span><br><span class="line">    finishRead-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    look-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    toReturn-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    finishCrea-&gt;<span class="built_in">hide</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::readIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> end=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    nowUser[<span class="number">0</span>]=account-&gt;<span class="built_in">text</span>();</span><br><span class="line">    nowUser[<span class="number">1</span>]=password-&gt;<span class="built_in">text</span>();</span><br><span class="line"></span><br><span class="line">    nowUser[<span class="number">0</span>]=account-&gt;<span class="built_in">text</span>();</span><br><span class="line">    <span class="keyword">if</span>(nowUser[<span class="number">0</span>]==<span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//拒绝空名</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;max<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(users[i][<span class="number">0</span>]==nowUser[<span class="number">0</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(users[i][<span class="number">1</span>]!=nowUser[<span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                end=<span class="number">1</span>;</span><br><span class="line">                <span class="comment">//结局1</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                now=i;</span><br><span class="line">                end=<span class="number">2</span>;</span><br><span class="line">                <span class="comment">//结局2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dialog *log=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(end)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        log-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;没有这个账号&quot;</span>);</span><br><span class="line">        log-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        <span class="built_in">reIn</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        log-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;密码错误&quot;</span>);</span><br><span class="line">        log-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        <span class="built_in">reIn</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        log-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">        log-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        stack-&gt;<span class="built_in">setCurrentWidget</span>(Game);</span><br><span class="line"></span><br><span class="line">        max--;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    log-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::creaIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> end=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    nowUser[<span class="number">0</span>]=account-&gt;<span class="built_in">text</span>();</span><br><span class="line">    <span class="keyword">if</span>(nowUser[<span class="number">0</span>]==<span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    nowUser[<span class="number">1</span>]=password-&gt;<span class="built_in">text</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> post=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;max<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(users[i][<span class="number">0</span>]==nowUser[<span class="number">0</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            end=<span class="number">1</span>;</span><br><span class="line">            <span class="comment">//结局1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   dialog* regist=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(end)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        regist-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;注册成功,进入游戏&quot;</span>);</span><br><span class="line">        regist-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        regist-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">        <span class="comment">//清空</span></span><br><span class="line"></span><br><span class="line">        now=max<span class="number">-1</span>;</span><br><span class="line">        stack-&gt;<span class="built_in">setCurrentWidget</span>(Game);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        regist-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;已有账号&quot;</span>);</span><br><span class="line">        regist-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        regist-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">reIn</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::hideShow</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(state==<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        password-&gt;<span class="built_in">setEchoMode</span>(QLineEdit::Normal);</span><br><span class="line">        state=<span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        password-&gt;<span class="built_in">setEchoMode</span>(QLineEdit::Password);</span><br><span class="line">        state=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::nullIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    out=<span class="literal">false</span>;</span><br><span class="line">    dialog *regist=<span class="keyword">new</span> <span class="built_in">dialog</span>();</span><br><span class="line">    regist-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;游客登录将无法计入数据&quot;</span>);</span><br><span class="line">    regist-&gt;<span class="built_in">exec</span>();</span><br><span class="line"></span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Game);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::readLog</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;log.bin&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    in&gt;&gt;max;</span><br><span class="line">    users=std::vector&lt;std::vector&lt;QString&gt;&gt;(max,std::<span class="built_in">vector</span>&lt;QString&gt;(<span class="number">5</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;max;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">5</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            in&gt;&gt;users[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;users[i][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    max++;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::writeLog</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(nowUser[<span class="number">0</span>]==<span class="string">&quot;Null&quot;</span>&amp;&amp;out==<span class="literal">false</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        dialog* ddd=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line">        ddd-&gt;<span class="built_in">readUser</span>(users,nowUser);</span><br><span class="line">        ddd-&gt;<span class="built_in">exec</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(nowUser[<span class="number">0</span>]==<span class="string">&quot;Null&quot;</span>||nowUser[<span class="number">0</span>]==<span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        now=max;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        now=max<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//考虑是否加入</span></span><br><span class="line"></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;log.bin&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::WriteOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">out</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    out&lt;&lt;max;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;max;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i==now)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">5</span>;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                out&lt;&lt;nowUser[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">5</span>;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                out&lt;&lt;users[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start::preStore</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">writeLog</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h2><p><img src="\img\image-20240525165027815.png" alt="image-20240525165027815" style="zoom:80%;" /></p>
<p>进入登录注册界面<br>分三个按钮，前两个会在输入账号密码时检测，第三个则直接进入游戏。</p>
<p><img src="\img\image-20240525165708790.png" alt="image-20240525165708790" style="zoom:80%;" /></p>
<p>这里没有切换界面，只是隐藏了部分按钮，点击返回时EDIT隐藏。<br>正确输入账号或者注册账号后进入下一个界面。</p>
<h1 id="game"><a href="#game" class="headerlink" title="game"></a>game</h1><h2 id="game-h"><a href="#game-h" class="headerlink" title="game.h"></a>game.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> GAME_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GAME_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStackedWidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;map.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hard.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;base.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ranking.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;storage.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">game</span> : <span class="keyword">public</span> Widget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">game</span>(QStackedWidget *,Widget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">relemap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//回到上级页面</span></span><br><span class="line">    ~<span class="built_in">game</span>();</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Clickbase</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//基础模式的跳转</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ClickHard</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//苦难的跳转</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ClickStorage</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//回顾的跳转</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//转置页面</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setBasePage</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//设置基础模式地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setSysPage</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//设置系统地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setHumPage</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//设置用户地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPastPage</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//设置回顾地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setlevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//初始填入排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">checkLevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//每次检视排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">writeLevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//写入排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">midMap</span><span class="params">(<span class="type">int</span> *)</span></span>;</span><br><span class="line">    <span class="comment">//中间地图过度</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::vector&lt;QPushButton*&gt; models;</span><br><span class="line">    QPushButton *score;</span><br><span class="line">    base *Base;</span><br><span class="line">    map *Map;</span><br><span class="line">    hard *Hard;</span><br><span class="line">    QStackedWidget *stack;</span><br><span class="line">    <span class="type">int</span> previousPage;</span><br><span class="line">    ranking *Level;</span><br><span class="line">    dialog* Dialog;</span><br><span class="line">    QStringList horHeaders;</span><br><span class="line">    storage *Storage;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// GAME_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="game-cpp"><a href="#game-cpp" class="headerlink" title="game.cpp"></a>game.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;game.h&quot;</span></span></span><br><span class="line">game::<span class="built_in">game</span>(QStackedWidget* s,Widget *parent)</span><br><span class="line">    : <span class="built_in">Widget</span>(parent)</span><br><span class="line">    ,   <span class="built_in">stack</span>(s)</span><br><span class="line">    , <span class="built_in">previousPage</span>(<span class="number">0</span>)</span><br><span class="line">    ,<span class="built_in">Dialog</span>(<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>))</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    horHeaders=<span class="built_in">QStringList</span>()&lt;&lt; <span class="string">&quot;玩家&quot;</span> &lt;&lt; <span class="string">&quot;困难通关数&quot;</span> &lt;&lt; <span class="string">&quot;通过关卡数&quot;</span> &lt;&lt; <span class="string">&quot;总积分&quot;</span>;</span><br><span class="line">    Level=<span class="keyword">new</span> <span class="built_in">ranking</span>(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *vlayout = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>(<span class="keyword">this</span>); <span class="comment">// 垂直布局</span></span><br><span class="line"></span><br><span class="line">    QWidget *buttonWidget = <span class="keyword">new</span> <span class="built_in">QWidget</span>(<span class="keyword">this</span>); <span class="comment">// 包含按钮的小部件</span></span><br><span class="line"></span><br><span class="line">    QWidget *scores=<span class="keyword">new</span> <span class="built_in">QWidget</span>(<span class="keyword">this</span>);<span class="comment">//包含分数的小部件</span></span><br><span class="line"></span><br><span class="line">    models.<span class="built_in">push_back</span>(<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;关卡模式&quot;</span>, buttonWidget));</span><br><span class="line">    models.<span class="built_in">push_back</span>(<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;挑战模式&quot;</span>, buttonWidget));</span><br><span class="line">    models.<span class="built_in">push_back</span>(<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;存储回顾&quot;</span>, buttonWidget)); <span class="comment">// 创建三个按钮</span></span><br><span class="line"></span><br><span class="line">    score = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;积分榜&quot;</span>,scores);<span class="comment">//积分榜按钮</span></span><br><span class="line"></span><br><span class="line">    <span class="function">QSizePolicy <span class="title">sizePolicy</span><span class="params">(QSizePolicy::Expanding, QSizePolicy::Expanding)</span></span>;</span><br><span class="line">    <span class="comment">//大小策略</span></span><br><span class="line"></span><br><span class="line">    score-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">    score-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">60</span>, <span class="number">20</span>));</span><br><span class="line">    score-&gt;<span class="built_in">setMaximumSize</span>(<span class="built_in">QSize</span>(<span class="number">240</span>, <span class="number">80</span>));</span><br><span class="line">    <span class="keyword">for</span>(QPushButton *button : models)</span><br><span class="line">    &#123;</span><br><span class="line">        button-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">        button-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">30</span>, <span class="number">20</span>));</span><br><span class="line">        button-&gt;<span class="built_in">setMaximumSize</span>(<span class="built_in">QSize</span>(<span class="number">240</span>, <span class="number">160</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为四个按钮设置大小</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *blayout = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(buttonWidget);</span><br><span class="line">    blayout-&gt;<span class="built_in">setSpacing</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="comment">// 设置组件之间的间距为100像素</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *slayout = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(scores);</span><br><span class="line">    <span class="comment">//两个水平布局（小部件）</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(QPushButton *button : models)</span><br><span class="line">    &#123;</span><br><span class="line">        blayout-&gt;<span class="built_in">addWidget</span>(button);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//为按钮设置</span></span><br><span class="line"></span><br><span class="line">    slayout-&gt;<span class="built_in">addStretch</span>();</span><br><span class="line">    slayout-&gt;<span class="built_in">addWidget</span>(score);</span><br><span class="line">    slayout-&gt;<span class="built_in">addStretch</span>();</span><br><span class="line">    <span class="comment">//为积分榜设置</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//vlayout-&gt;addStretch(); // 垂直布局在顶部放置一个伸缩空间，将水平布局推到底部</span></span><br><span class="line">    vlayout-&gt;<span class="built_in">addWidget</span>(scores);</span><br><span class="line">    <span class="comment">//vlayout-&gt;addStretch(); // 在水平布局和窗口底部之间添加一个伸缩空间</span></span><br><span class="line">    vlayout-&gt;<span class="built_in">addWidget</span>(buttonWidget);</span><br><span class="line">    <span class="comment">//为垂直布局设置</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(models[<span class="number">0</span>], &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;game::Clickbase);</span><br><span class="line">    <span class="comment">// 关卡模式槽函数</span></span><br><span class="line">    <span class="built_in">connect</span>(models[<span class="number">1</span>], &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;game::ClickHard);</span><br><span class="line">    <span class="comment">// 挑战模式槽函数</span></span><br><span class="line">    <span class="built_in">connect</span>(models[<span class="number">2</span>],&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;game::ClickStorage);</span><br><span class="line"></span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    Base = <span class="keyword">new</span> <span class="built_in">base</span>(<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(Base);</span><br><span class="line">    Hard=<span class="keyword">new</span> <span class="built_in">hard</span>(<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(Hard);</span><br><span class="line">    Map=<span class="keyword">new</span> <span class="built_in">map</span>(<span class="keyword">this</span>);</span><br><span class="line">    Storage=<span class="keyword">new</span> <span class="built_in">storage</span>(<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(Storage);</span><br><span class="line">    stack-&gt;<span class="built_in">addWidget</span>(Map);</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    stack-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(Base,&amp;base::repage,<span class="keyword">this</span>,&amp;game::repage);</span><br><span class="line">    <span class="comment">//返回到关卡模式</span></span><br><span class="line">    <span class="built_in">connect</span>(Hard,&amp;hard::repage,<span class="keyword">this</span>,&amp;game::repage);</span><br><span class="line">    <span class="comment">//返回</span></span><br><span class="line">    <span class="built_in">connect</span>(Base, &amp;base::tomap, <span class="keyword">this</span>,&amp;game::setBasePage);</span><br><span class="line">    <span class="comment">//关卡模式的地图返回</span></span><br><span class="line">    <span class="built_in">connect</span>(Hard,&amp;hard::Cretomap,<span class="keyword">this</span>,&amp;game::setSysPage);</span><br><span class="line">    <span class="built_in">connect</span>(Hard,&amp;hard::HumtoMap,<span class="keyword">this</span>,&amp;game::setHumPage);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(Map, &amp;map::back,<span class="keyword">this</span>,&amp;game::relemap);</span><br><span class="line">    <span class="comment">//检测map的返回操作，若有，则将记录的页面给上去</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(score,&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;game::checkLevel);</span><br><span class="line">    <span class="comment">//更新排行榜</span></span><br><span class="line">    <span class="built_in">connect</span>(Storage,&amp;storage::over, <span class="keyword">this</span>,&amp;game::setPastPage);</span><br><span class="line">    <span class="comment">//设置回顾</span></span><br><span class="line">    <span class="built_in">connect</span>(Storage,&amp;storage::repage, <span class="keyword">this</span>,&amp;game::repage);</span><br><span class="line">    <span class="comment">//回顾的返回</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">setlevel</span>();</span><br><span class="line">    <span class="comment">//填入数组</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::setBasePage</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    previousPage = stack-&gt;<span class="built_in">currentIndex</span>();</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    Base-&gt;<span class="built_in">readMap</span>(i);</span><br><span class="line">    <span class="comment">//读取地图</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//读取排行榜</span></span><br><span class="line">    Map-&gt;<span class="built_in">readmap</span>(Base-&gt;<span class="built_in">reBaseMap</span>(),Base-&gt;<span class="built_in">reBaseSolution</span>());</span><br><span class="line">    <span class="comment">//填充地图</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">setModule</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">//设置模式</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">putmap</span>();</span><br><span class="line">    <span class="comment">//初始化等操作</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">setIn</span>(i);</span><br><span class="line">    <span class="comment">//调用对应数组</span></span><br><span class="line"></span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Map);</span><br><span class="line">    <span class="comment">//添加到页面</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::setSysPage</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    previousPage = stack-&gt;<span class="built_in">currentIndex</span>();</span><br><span class="line"></span><br><span class="line">    Hard-&gt;<span class="built_in">createMap</span>();</span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">readmap</span>(Hard-&gt;<span class="built_in">reMap</span>(),Hard-&gt;<span class="built_in">reSolution</span>());</span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">setModule</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//设置模式</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">putmap</span>();</span><br><span class="line">    <span class="comment">//初始</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">setIn</span>(<span class="number">6</span>);</span><br><span class="line">    <span class="comment">//调用对应数组</span></span><br><span class="line"></span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Map);</span><br><span class="line">    <span class="comment">//添加到页面</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::setHumPage</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    previousPage = stack-&gt;<span class="built_in">currentIndex</span>();</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    dialog* humMap=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(humMap,&amp;dialog::outData,<span class="keyword">this</span>,&amp;game::midMap);</span><br><span class="line">    <span class="comment">//调用对应</span></span><br><span class="line"></span><br><span class="line">    humMap-&gt;<span class="built_in">getMap</span>();</span><br><span class="line">    humMap-&gt;<span class="built_in">exec</span>();</span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">setModule</span>(<span class="number">2</span>);</span><br><span class="line">    Map-&gt;<span class="built_in">putmap</span>();</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Map);</span><br><span class="line">    <span class="comment">//添加到页面</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::setPastPage</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    previousPage = stack-&gt;<span class="built_in">currentIndex</span>();</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    Storage-&gt;<span class="built_in">reSet</span>();</span><br><span class="line">    Storage-&gt;<span class="built_in">readMap</span>(i);</span><br><span class="line">    <span class="comment">//读取地图</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">readmap</span>(Storage-&gt;<span class="built_in">reMap</span>(),Storage-&gt;<span class="built_in">reSolution</span>());</span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">putmap</span>();</span><br><span class="line">    <span class="comment">//初始</span></span><br><span class="line"></span><br><span class="line">    Map-&gt;<span class="built_in">setModule</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="comment">//设置模式</span></span><br><span class="line"></span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Map);</span><br><span class="line">    <span class="comment">//添加到页面</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::Clickbase</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Base);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::ClickHard</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Hard);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::ClickStorage</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Storage-&gt;<span class="built_in">reSet</span>();</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(Storage);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::repage</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">game::~<span class="built_in">game</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(Level!=<span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> Level;</span><br><span class="line">    &#125;</span><br><span class="line">    Level=<span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::relemap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack-&gt;<span class="built_in">setCurrentIndex</span>(previousPage);</span><br><span class="line">    <span class="comment">//设置当前页面</span></span><br><span class="line">    <span class="comment">// Map-&gt;dele();</span></span><br><span class="line">    <span class="comment">// //释放关卡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::setlevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;totalLevel.bin&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    in&gt;&gt;*Level;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::checkLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(nowUser[<span class="number">0</span>]==<span class="string">&quot;Null&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Dialog-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;游客不能访问排行榜&quot;</span>);</span><br><span class="line">        Dialog-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Level-&gt;<span class="built_in">toCheckLevel</span>(nowUser);</span><br><span class="line">    <span class="comment">//对比</span></span><br><span class="line"></span><br><span class="line">    Dialog-&gt;<span class="built_in">setLevel</span>(*Level,horHeaders);</span><br><span class="line">    Dialog-&gt;<span class="built_in">exec</span>();</span><br><span class="line">    <span class="comment">//调出排行榜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::writeLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;totalLevel.bin&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::WriteOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">out</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    out&lt;&lt;*Level;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">game::midMap</span><span class="params">(<span class="type">int</span>* a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> solution[<span class="number">7</span>]=&#123;<span class="number">-1</span>&#125;;</span><br><span class="line">    Map-&gt;<span class="built_in">readmap</span>(a,solution);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-3"><a href="#介绍-3" class="headerlink" title="介绍"></a>介绍</h2><p><img src="\img\image-20240525170412988.png" alt="image-20240525170412988" style="zoom:80%;" /></p>
<p>这里使用了游客登录，进入了游戏界面，有三个大模块，分别为基础，困难和回顾，分别通往三个界面。<br>还有排行榜，由dialog窗口唤出<br><img src="\img\image-20240525172147781.png" alt="image-20240525172147781"><br>game将自己的排行数组传给dialog，然后在dialog中比较并修改，在展示。</p>
<p>现在点击基础模式</p>
<h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><h3 id="base-h"><a href="#base-h" class="headerlink" title="base.h"></a>base.h</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> BASE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BASE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">base</span> : <span class="keyword">public</span> Widget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">base</span>(QWidget *parent=<span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">base</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readMap</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//读取全部</span></span><br><span class="line">    <span class="function"><span class="type">int</span>* <span class="title">reBaseMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回地图</span></span><br><span class="line">    <span class="function"><span class="type">int</span>* <span class="title">reBaseSolution</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回答案</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">tomap</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clickback</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回信号</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clicklevel</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//进入的关卡</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QPushButton* back;</span><br><span class="line">    std::vector&lt;QPushButton*&gt; bases;</span><br><span class="line">    <span class="type">int</span> baseMap[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> baseSolution[<span class="number">7</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// BASE_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="base-cpp"><a href="#base-cpp" class="headerlink" title="base.cpp"></a>base.cpp</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;base.h&quot;</span></span></span><br><span class="line">base::<span class="built_in">base</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">Widget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    QWidget *basewid=<span class="keyword">new</span> <span class="built_in">QWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    QWidget *backwid=<span class="keyword">new</span> <span class="built_in">QWidget</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">QSizePolicy <span class="title">sizePolicy</span><span class="params">(QSizePolicy::Expanding, QSizePolicy::Expanding)</span></span>;</span><br><span class="line">    <span class="comment">//大小策略</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        QString name = <span class="string">&quot;第&quot;</span> + QString::<span class="built_in">number</span>(i + <span class="number">1</span>) + <span class="string">&quot;关&quot;</span>; <span class="comment">// 构造按钮名称，例如 &quot;第1关&quot;, &quot;第2关&quot;, 等等</span></span><br><span class="line">        bases.<span class="built_in">push_back</span>(<span class="keyword">new</span> <span class="built_in">QPushButton</span>(name, <span class="keyword">this</span>)); <span class="comment">// 将按钮添加到 bases 数组中</span></span><br><span class="line">        bases[i]-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">        bases[i]-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">30</span>, <span class="number">20</span>));</span><br><span class="line">        bases[i]-&gt;<span class="built_in">setMaximumSize</span>(<span class="built_in">QSize</span>(<span class="number">240</span>, <span class="number">160</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    QHBoxLayout *base_layout = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(basewid);</span><br><span class="line">    <span class="comment">//添加水平布局</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *back_layout=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(backwid);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *vlayout = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// 垂直布局</span></span><br><span class="line"></span><br><span class="line">    base_layout-&gt;<span class="built_in">setSpacing</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="comment">// 设置组件之间的间距为100像素</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(QPushButton *button : bases)</span><br><span class="line">    &#123;</span><br><span class="line">        base_layout-&gt;<span class="built_in">addWidget</span>(button);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    back=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>,backwid);</span><br><span class="line">    back-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">    back-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">40</span>, <span class="number">30</span>));</span><br><span class="line">    back_layout-&gt;<span class="built_in">addWidget</span>(back);</span><br><span class="line"></span><br><span class="line">    vlayout-&gt;<span class="built_in">addWidget</span>(backwid);</span><br><span class="line">    vlayout-&gt;<span class="built_in">addStretch</span>();</span><br><span class="line">    vlayout-&gt;<span class="built_in">addWidget</span>(basewid);</span><br><span class="line">    <span class="comment">// 初始化按钮任务</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(back,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;base::clickback);</span><br><span class="line">    <span class="comment">// 关卡模式返回</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">connect</span>(bases[i],&amp;QPushButton::clicked,[<span class="keyword">this</span>, i]() &#123; <span class="built_in">clicklevel</span>(i); &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6个按钮的地图进入</span></span><br><span class="line">&#125;</span><br><span class="line">base::~<span class="built_in">base</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (QPushButton* button : bases)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> button;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(back!=<span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">delete</span> back;</span><br><span class="line">    back=<span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">base::clickback</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">emit <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">base::clicklevel</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">emit <span class="title">tomap</span><span class="params">(i)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">base::readMap</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;basemap.bin&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;basemap not open&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">ifs</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">    <span class="type">int</span> temp=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">43</span>*a;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ifs&gt;&gt;temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">36</span>; j++) &#123;</span><br><span class="line">        ifs &gt;&gt;baseMap[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ifs&gt;&gt;baseSolution[i];</span><br><span class="line">    &#125;</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">base::reBaseMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> baseMap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">base::reBaseSolution</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> baseSolution;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="介绍-4"><a href="#介绍-4" class="headerlink" title="介绍"></a>介绍</h3><p><img src="\img\image-20240525170625090.png" alt="image-20240525170625090"></p>
<p>现在进入了基础模式界面，内含六个关卡，点击对应的按钮后读取地图，然后将地图传递给最核心的页面————地图。</p>
<h2 id="hard"><a href="#hard" class="headerlink" title="hard"></a>hard</h2><h3 id="hard-h"><a href="#hard-h" class="headerlink" title="hard.h"></a>hard.h</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> HARD_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HARD_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hard</span> :<span class="keyword">public</span> Widget<span class="comment">//系统和自主</span></span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">hard</span>(QWidget *parent=<span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">hard</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">sysCreate</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//系统创建地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">humCreate</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//用户创建</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">createMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//系统创建地图</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">checkFour</span><span class="params">(<span class="type">int</span>*,<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//判断随机的四个初始拼图是否合法</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">choiceSys</span><span class="params">(<span class="type">int</span>*,<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//根据number存入的合法位置，得到随机地址的合法性</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findFour</span><span class="params">(<span class="type">int</span>*,<span class="type">int</span>,<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//找到基于位置4的合法最大位置</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">endMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//根据solution得到地图，检查地图后就可以开工了</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readLevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//读入地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">writeLevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//写入地图</span></span><br><span class="line">    <span class="function"><span class="type">int</span>* <span class="title">reMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回地图</span></span><br><span class="line">    <span class="function"><span class="type">int</span>* <span class="title">reSolution</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回答案</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Cretomap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">HumtoMap</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clickback</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回信号</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> workmap[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> solution[<span class="number">7</span>];</span><br><span class="line">    std::vector&lt;std::vector&lt;<span class="type">int</span>&gt;&gt; number;<span class="comment">//记录随机地点</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// HARD_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="hard-cpp"><a href="#hard-cpp" class="headerlink" title="hard.cpp"></a>hard.cpp</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hard.h&quot;</span></span></span><br><span class="line">hard::<span class="built_in">hard</span>(QWidget *parent)</span><br><span class="line">    :   <span class="built_in">Widget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    QPushButton *autoMap=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;系统生成&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    QPushButton *customMap=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;用户输入&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    QPushButton *_return=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//设置两个子模式</span></span><br><span class="line"></span><br><span class="line">    <span class="function">QSizePolicy <span class="title">sizePolicy</span><span class="params">(QSizePolicy::Expanding, QSizePolicy::Expanding)</span></span>;<span class="comment">//大小策略</span></span><br><span class="line">    autoMap-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">    autoMap-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">60</span>, <span class="number">20</span>));</span><br><span class="line">    autoMap-&gt;<span class="built_in">setMaximumSize</span>(<span class="built_in">QSize</span>(<span class="number">240</span>, <span class="number">80</span>));</span><br><span class="line">    customMap-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">    customMap-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">60</span>, <span class="number">20</span>));</span><br><span class="line">    customMap-&gt;<span class="built_in">setMaximumSize</span>(<span class="built_in">QSize</span>(<span class="number">240</span>, <span class="number">80</span>));</span><br><span class="line">    _return-&gt;<span class="built_in">setSizePolicy</span>(sizePolicy);</span><br><span class="line">    _return-&gt;<span class="built_in">setMinimumSize</span>(<span class="built_in">QSize</span>(<span class="number">120</span>, <span class="number">50</span>));</span><br><span class="line">    _return-&gt;<span class="built_in">setMaximumSize</span>(<span class="built_in">QSize</span>(<span class="number">440</span>, <span class="number">130</span>));</span><br><span class="line">    <span class="comment">//设置按钮尺寸</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *mode=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    QVBoxLayout *frame=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//两个布局</span></span><br><span class="line"></span><br><span class="line">    mode-&gt;<span class="built_in">addWidget</span>(autoMap);</span><br><span class="line">    mode-&gt;<span class="built_in">addWidget</span>(customMap);</span><br><span class="line">    mode-&gt;<span class="built_in">addWidget</span>(_return);</span><br><span class="line"></span><br><span class="line">    frame-&gt;<span class="built_in">addLayout</span>(mode);</span><br><span class="line">    <span class="comment">//框架</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(autoMap,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;hard::sysCreate);</span><br><span class="line">    <span class="comment">// connect(autoMap,&amp;QPushButton::clicked,this);</span></span><br><span class="line">    <span class="built_in">connect</span>(_return,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;hard::clickback);</span><br><span class="line">    <span class="built_in">connect</span>(customMap,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;hard::humCreate);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">hard::~<span class="built_in">hard</span>()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">hard::clickback</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">emit <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">hard::sysCreate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">emit <span class="title">Cretomap</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">hard::humCreate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">emit <span class="title">HumtoMap</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">hard::createMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    number = &#123;</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>&#125; &#125;;</span><br><span class="line">    <span class="comment">//number 的初始化</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pos4 = <span class="number">0</span>;<span class="comment">//位置4</span></span><br><span class="line">    <span class="type">int</span> autopost[<span class="number">5</span>] = &#123;&#125;; <span class="comment">// 随机到了哪副拼图</span></span><br><span class="line">    <span class="type">int</span> autoposi[<span class="number">8</span>] = &#123;&#125;; <span class="comment">// 记录哪副没有被随机,方便check</span></span><br><span class="line">    <span class="type">int</span> onerand = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (;;)</span><br><span class="line">    &#123;</span><br><span class="line">        pos4 = <span class="built_in">rand</span>() % <span class="number">36</span> + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (;;)</span><br><span class="line">            &#123;</span><br><span class="line">                onerand = <span class="built_in">rand</span>() % <span class="number">7</span> + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">checkFour</span>(autopost, onerand))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            autopost[i] = onerand; <span class="comment">// 1~7</span></span><br><span class="line">            autoposi[autopost[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 得到一个不重复的数组</span></span><br><span class="line">        <span class="built_in">choiceSys</span>(autopost, pos4);</span><br><span class="line">        <span class="comment">// 对以上四个解得到结果</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">7</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (autoposi[i] != <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> erand = <span class="built_in">rand</span>() % (number[i - <span class="number">1</span>].<span class="built_in">size</span>());</span><br><span class="line">                solution[i<span class="number">-1</span>]=number[i<span class="number">-1</span>][erand];</span><br><span class="line">                <span class="comment">// 得到随机数</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//现在得到了7副拼图的位置信息</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">endMap</span>())</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 先得到随机的要合成“4”的拼图和位置，然后随机剩余的，</span></span><br><span class="line"><span class="comment">//最后根据随机的记录生成work。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">hard::choiceSys</span><span class="params">(<span class="type">int</span>* autopost, <span class="type">int</span> pos4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 以pos4作为能覆盖区域的最大值，最小值选择</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">    <span class="comment">// 判断choice是否覆盖</span></span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> findmax = <span class="built_in">findFour</span>(number[autopost[i] - <span class="number">1</span>].<span class="built_in">data</span>(), number[autopost[i] - <span class="number">1</span>].<span class="built_in">size</span>() - <span class="number">1</span>, pos4);</span><br><span class="line">        <span class="comment">// 拿到最大位置</span></span><br><span class="line">        <span class="type">int</span> findmin = <span class="number">0</span>; <span class="comment">// 得到最小位置</span></span><br><span class="line">        <span class="type">int</span> erand = <span class="number">0</span>;   <span class="comment">// 最后的随机</span></span><br><span class="line">        <span class="keyword">switch</span> (autopost[i])</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            erand = pos4;</span><br><span class="line">            solution[autopost[i]<span class="number">-1</span>]=erand; <span class="comment">// 7，6在number中的上下限为1</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>: <span class="comment">// 重构得到最小位置</span></span><br><span class="line">            findmin = findmax - <span class="number">6</span>;</span><br><span class="line">            <span class="keyword">if</span> (findmin &lt; <span class="number">0</span>)</span><br><span class="line">                findmin = <span class="number">0</span>; <span class="comment">// 移动到指定位置（左上角</span></span><br><span class="line">            erand = <span class="built_in">rand</span>() % (findmax - findmin) + findmin;</span><br><span class="line">            solution[autopost[i]<span class="number">-1</span>]=number[autopost[i] - <span class="number">1</span>][erand];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            findmin = findmax - <span class="number">4</span>; <span class="comment">// 移动到指定位置（左上角</span></span><br><span class="line">            <span class="keyword">if</span> (findmin &lt; <span class="number">0</span>)</span><br><span class="line">                findmin = <span class="number">0</span>;</span><br><span class="line">            erand = <span class="built_in">rand</span>() % (findmax - findmin) + findmin;</span><br><span class="line">            solution[autopost[i]<span class="number">-1</span>]=number[autopost[i] - <span class="number">1</span>][erand];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 重构得到最小位置</span></span><br><span class="line">            findmin = findmax - <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">if</span> (findmin &lt; <span class="number">0</span>)</span><br><span class="line">                findmin = <span class="number">0</span>; <span class="comment">// 移动到指定位置（左上角</span></span><br><span class="line">            erand = <span class="built_in">rand</span>() % (findmax - findmin) + findmin;</span><br><span class="line">            solution[autopost[i]<span class="number">-1</span>]=number[autopost[i] - <span class="number">1</span>][erand];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">hard::findFour</span><span class="params">(<span class="type">int</span>* a, <span class="type">int</span> end, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function">    <span class="comment">// 得到位置“4”的地点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 二分查找</span></span><br><span class="line">    <span class="type">int</span> str = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> empt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; str &lt;= end;)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> min = (str + end) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a[min] &lt;= c)</span><br><span class="line">        &#123;</span><br><span class="line">            str = min + <span class="number">1</span>;</span><br><span class="line">            empt = min;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            end = min - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> empt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">hard::checkFour</span><span class="params">(<span class="type">int</span>* post,<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (post[i]==n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">hard::endMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> work_map[<span class="number">36</span>]=&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> empt = solution[i];</span><br><span class="line">        <span class="comment">// 拿到随机到的结果</span></span><br><span class="line">        <span class="keyword">switch</span> (i+<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            work_map[empt]++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            work_map[empt]++;</span><br><span class="line">            work_map[empt + <span class="number">1</span>]++;</span><br><span class="line">            work_map[empt + <span class="number">6</span>]++;</span><br><span class="line">            work_map[empt + <span class="number">7</span>]++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) <span class="comment">// 9格有点多，循环吧</span></span><br><span class="line">            &#123;</span><br><span class="line">                work_map[empt + i]++;</span><br><span class="line">                work_map[empt + <span class="number">6</span> + i]++;</span><br><span class="line">                work_map[empt + <span class="number">12</span> + i]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) <span class="comment">// 16格有点多，循环吧</span></span><br><span class="line">            &#123;</span><br><span class="line">                work_map[empt + i]++;</span><br><span class="line">                work_map[empt + <span class="number">6</span> + i]++;</span><br><span class="line">                work_map[empt + <span class="number">12</span> + i]++;</span><br><span class="line">                work_map[empt + <span class="number">18</span> + i]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">36</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (work_map[i] &gt; <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (work_map[i] == <span class="number">4</span>)</span><br><span class="line">            count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (count != <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> empt = work_map[i]; <span class="comment">// 拿到随机到的结果</span></span><br><span class="line">            <span class="keyword">switch</span> (empt)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                workmap[i]=<span class="number">4</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                workmap[i]=<span class="number">3</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                workmap[i]=<span class="number">3</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                workmap[i]=<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                workmap[i]=<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//文本替换</span></span><br><span class="line"></span><br><span class="line">        <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;hardMap.bin&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::Append))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">QDataStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            in&lt;&lt;workmap[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            in&lt;&lt;solution[i];</span><br><span class="line">        &#125;</span><br><span class="line">        file.<span class="built_in">close</span>();</span><br><span class="line">        <span class="comment">//写入地图</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">hard::reMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> workmap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">hard::reSolution</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> solution;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="介绍-5"><a href="#介绍-5" class="headerlink" title="介绍"></a>介绍</h3><p><img src="\img\image-20240525171548571.png" alt="image-20240525171548571"></p>
<p>这个页面包含三个按钮，分别为系统生成，用户创建，返回。<br>点击系统生成，系统会自动将生成的地图写入文件，然后将副本传入map。<br>点击用户创建，弹出弹窗，输入地图判断后，将地图信息传入map。<br><img src="\img\image-20240525172359407.png" alt="image-20240525172359407"><br>该图为用户子输入的弹窗。</p>
<h2 id="storage"><a href="#storage" class="headerlink" title="storage"></a>storage</h2><h3 id="storage-h"><a href="#storage-h" class="headerlink" title="storage.h"></a>storage.h</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> STORAGE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STORAGE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLineEdit&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">storage</span> : <span class="keyword">public</span> Widget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">storage</span>(QWidget *parent=<span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">storage</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readTotal</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//读取地图个数</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readMap</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//读取地图文件</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">startIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//进入作答</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reSet</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//重置</span></span><br><span class="line">    <span class="function"><span class="type">int</span>* <span class="title">reMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回地图</span></span><br><span class="line">    <span class="function"><span class="type">int</span>* <span class="title">reSolution</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回解决方案</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clickBack</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">over</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> total;</span><br><span class="line">    <span class="type">int</span> workMap[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> solution[<span class="number">7</span>];</span><br><span class="line">    QLineEdit *choice;</span><br><span class="line">    QPushButton *start;</span><br><span class="line">    QPushButton *re;</span><br><span class="line">    QLabel *tips;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// STORAGE_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="storage-cpp"><a href="#storage-cpp" class="headerlink" title="storage.cpp"></a>storage.cpp</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;storage.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">storage::<span class="built_in">storage</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">Widget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    total=<span class="number">100</span>;</span><br><span class="line">    <span class="built_in">readTotal</span>();</span><br><span class="line"></span><br><span class="line">    start=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;开始&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    start-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    re=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    re-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    tips=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    tips-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    tips-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: green;&quot;</span>);</span><br><span class="line">    tips-&gt;<span class="built_in">setAlignment</span>(Qt::AlignCenter);</span><br><span class="line">    choice=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="keyword">this</span>);</span><br><span class="line">    choice-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;输入数字以进入关卡，请勿输入非法字符及0&quot;</span>);</span><br><span class="line">    tips-&gt;<span class="built_in">setText</span>(<span class="string">&quot;目前存在&quot;</span>+QString::<span class="built_in">number</span>(total)+<span class="string">&quot;关&quot;</span>);</span><br><span class="line">    <span class="comment">//基本组件</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *hlayout=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    QVBoxLayout *vlayout=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//布局</span></span><br><span class="line"></span><br><span class="line">    hlayout-&gt;<span class="built_in">addWidget</span>(start);</span><br><span class="line">    hlayout-&gt;<span class="built_in">addWidget</span>(re);</span><br><span class="line">    vlayout-&gt;<span class="built_in">addWidget</span>(tips);</span><br><span class="line">    vlayout-&gt;<span class="built_in">addWidget</span>(choice);</span><br><span class="line">    vlayout-&gt;<span class="built_in">addLayout</span>(hlayout);</span><br><span class="line">    <span class="comment">//添加</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(start,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;storage::startIn);</span><br><span class="line">    <span class="built_in">connect</span>(re,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;storage::clickBack);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">storage::~<span class="built_in">storage</span>()&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">storage::clickBack</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">emit <span class="title">repage</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">storage::reSet</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">readTotal</span>();</span><br><span class="line">    tips-&gt;<span class="built_in">setText</span>(<span class="string">&quot;目前存在&quot;</span>+QString::<span class="built_in">number</span>(total)+<span class="string">&quot;关&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">storage::readTotal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;hardMap.bin&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> empt=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!file.<span class="built_in">atEnd</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        in&gt;&gt;empt;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total=count/<span class="number">43</span>;</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">storage::readMap</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;hardMap.bin&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> empt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">43</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            in&gt;&gt;empt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        in&gt;&gt;workMap[i];</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;workMap[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        in&gt;&gt;solution[i];</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;solution[i];</span><br><span class="line">    &#125;</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">storage::startIn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> set=choice-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>();</span><br><span class="line">    <span class="keyword">if</span>(set==<span class="number">0</span>||set&gt;total||total&lt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        dialog *empt=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line">        empt-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;输入错误或地图不足&quot;</span>);</span><br><span class="line">        empt-&gt;<span class="built_in">exec</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        emit <span class="built_in">over</span>(set);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">storage::reMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> workMap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">storage::reSolution</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> solution;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="介绍-6"><a href="#介绍-6" class="headerlink" title="介绍"></a>介绍</h3><p>在这个界面中<br><img src="\img\image-20240525172641630.png" alt="image-20240525172641630"><br>有如上的界面，读取存储了所有地图的文件后拿到地图数，用户输入后跳转</p>
<h1 id="map"><a href="#map" class="headerlink" title="map"></a>map</h1><p>这里是最核心的类</p>
<h2 id="map-h"><a href="#map-h" class="headerlink" title="map.h"></a>map.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MAP_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTimer&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDateTime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextStream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGridLayout&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;draglabel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;droplabel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ranking.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">map</span>:<span class="keyword">public</span> Widget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">map</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">map</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readmap</span><span class="params">(<span class="type">int</span>*,<span class="type">int</span>*)</span></span>;</span><br><span class="line">    <span class="comment">//读取地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putmap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//设置地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pause_on</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//暂停或继续</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//更新时间</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">check</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//检查是否做对</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">nullMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//创建空地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">humanMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//输入地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">forState</span><span class="params">(<span class="type">int</span>,<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//记录回溯信息</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">cleanBack</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//清空回溯数组</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">toBack</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//回溯</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">helpMe</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//帮帮我</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setIn</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//传入排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">writeOut</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//写入排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">compare</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//对比排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">callLevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//唤出排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">popLevel</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//隐藏排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setModule</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//切换模式</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">calculate</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//计算积分</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">callTools</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//呼唤工具</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">back</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> nowIndex;</span><br><span class="line">    <span class="type">int</span> now_back;</span><br><span class="line">    <span class="type">int</span> now_help;</span><br><span class="line">    QGridLayout *gridLayout;</span><br><span class="line">    QGridLayout *menu;</span><br><span class="line">    <span class="type">int</span> workmap[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> solution[<span class="number">7</span>];</span><br><span class="line">    std::vector&lt;QLabel*&gt; piclabel;</span><br><span class="line">    std::vector&lt;DragLabel*&gt; uselabel;</span><br><span class="line">    std::vector&lt;DropLabel*&gt; droplabels;</span><br><span class="line">    <span class="type">bool</span> state;</span><br><span class="line">    QPushButton* start;</span><br><span class="line">    QPushButton* pullBack;</span><br><span class="line">    QPushButton* help;</span><br><span class="line">    QPushButton* inLevel;</span><br><span class="line">    QPushButton* tools;</span><br><span class="line">    QLabel* time;</span><br><span class="line">    QTimer *timer;</span><br><span class="line">    QDateTime nowtime;</span><br><span class="line">    QDateTime lasttime;</span><br><span class="line">    QLabel *helpCounter;</span><br><span class="line">    QLabel *backCounter;</span><br><span class="line">    std::vector&lt;std::vector&lt;QString&gt;&gt; dropBack;</span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; dragBack;</span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; helpInt;</span><br><span class="line">    ranking *level;</span><br><span class="line">    QStringList horHeaders;</span><br><span class="line">    <span class="type">int</span> <span class="keyword">module</span>;</span><br><span class="line">    <span class="type">int</span> fault;</span><br><span class="line">    <span class="comment">//0为关卡，1为挑战，2为自定义，3为回顾</span></span><br><span class="line">    QString now_time;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// MAP_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="map-cpp"><a href="#map-cpp" class="headerlink" title="map.cpp"></a>map.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;map.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">map::<span class="built_in">map</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">Widget</span>(parent),</span><br><span class="line">    <span class="built_in">nowIndex</span>(<span class="number">110</span>)</span><br><span class="line">    ,<span class="built_in">now_back</span>(<span class="number">0</span>)</span><br><span class="line">    ,<span class="built_in">now_help</span>(<span class="number">0</span>)</span><br><span class="line">    ,<span class="built_in">state</span>(<span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    level=<span class="keyword">new</span> <span class="built_in">ranking</span>(<span class="number">2</span>);</span><br><span class="line">    fault=<span class="number">0</span>;</span><br><span class="line">    horHeaders=<span class="built_in">QStringList</span>()&lt;&lt; <span class="string">&quot;玩家&quot;</span> &lt;&lt; <span class="string">&quot;本关用时&quot;</span>;</span><br><span class="line"></span><br><span class="line">    helpInt=std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; (<span class="number">7</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">36</span>; ++i) &#123;</span><br><span class="line">        piclabel.<span class="built_in">push_back</span>(<span class="keyword">new</span> QLabel);</span><br><span class="line">    &#125;<span class="comment">//初始化36副图片</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; ++i) &#123;</span><br><span class="line">        uselabel.<span class="built_in">push_back</span>(<span class="keyword">new</span> DragLabel);</span><br><span class="line">    &#125;<span class="comment">//初始化7副拼图</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        droplabels.<span class="built_in">push_back</span>(<span class="keyword">new</span> DropLabel);</span><br><span class="line">        droplabels[i]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">        droplabels[i]-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        droplabels[i]-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: green;&quot;</span>);</span><br><span class="line">        droplabels[i]-&gt;<span class="built_in">setAlignment</span>(Qt::AlignCenter);</span><br><span class="line">    &#125;<span class="comment">//初始化拖拽标签</span></span><br><span class="line"></span><br><span class="line">    <span class="function">QPixmap <span class="title">map1</span><span class="params">(<span class="string">&quot;:/image/4.png&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QPixmap <span class="title">map2</span><span class="params">(<span class="string">&quot;:/image/3.png&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QPixmap <span class="title">map3</span><span class="params">(<span class="string">&quot;:/image/2.png&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QPixmap <span class="title">map4</span><span class="params">(<span class="string">&quot;:/image/1.png&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">0</span>]-&gt;<span class="built_in">setPixmap</span>(map1);</span><br><span class="line">    uselabel[<span class="number">0</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">0</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">1</span>]-&gt;<span class="built_in">setPixmap</span>(map2);</span><br><span class="line">    uselabel[<span class="number">1</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">1</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">2</span>]-&gt;<span class="built_in">setPixmap</span>(map2);</span><br><span class="line">    uselabel[<span class="number">2</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">2</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">3</span>]-&gt;<span class="built_in">setPixmap</span>(map3);</span><br><span class="line">    uselabel[<span class="number">3</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">3</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">4</span>]-&gt;<span class="built_in">setPixmap</span>(map3);</span><br><span class="line">    uselabel[<span class="number">4</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">4</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">5</span>]-&gt;<span class="built_in">setPixmap</span>(map4);</span><br><span class="line">    uselabel[<span class="number">5</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;6&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">5</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">6</span>]-&gt;<span class="built_in">setPixmap</span>(map4);</span><br><span class="line">    uselabel[<span class="number">6</span>]-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;7&quot;</span>);</span><br><span class="line">    uselabel[<span class="number">6</span>]-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//初始化7副拼图</span></span><br><span class="line"></span><br><span class="line">    uselabel[<span class="number">0</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">280</span>,<span class="number">280</span>);</span><br><span class="line">    uselabel[<span class="number">1</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">120</span>,<span class="number">120</span>);</span><br><span class="line">    uselabel[<span class="number">2</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">120</span>,<span class="number">120</span>);</span><br><span class="line">    uselabel[<span class="number">3</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    uselabel[<span class="number">4</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    uselabel[<span class="number">5</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    uselabel[<span class="number">6</span>]-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    <span class="comment">// 创建一个网格布局</span></span><br><span class="line">    gridLayout = <span class="keyword">new</span> <span class="built_in">QGridLayout</span>();</span><br><span class="line">    gridLayout-&gt;<span class="built_in">setSpacing</span>(<span class="number">0</span>);</span><br><span class="line">    gridLayout-&gt;<span class="built_in">setHorizontalSpacing</span>(<span class="number">0</span>);  <span class="comment">// 设置水平间距</span></span><br><span class="line">    gridLayout-&gt;<span class="built_in">setVerticalSpacing</span>(<span class="number">0</span>);    <span class="comment">// 设置垂直间距</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置网格布局的大小策略为 Fixed，确保不会在大小不匹配时拉伸</span></span><br><span class="line">    gridLayout-&gt;<span class="built_in">setSizeConstraint</span>(QLayout::SetFixedSize);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加图片和拼图到网格布局</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> index = i * <span class="number">6</span> + j;</span><br><span class="line">            DropLabel *dropLabel = droplabels[index];</span><br><span class="line">            <span class="comment">//二者对应的指针</span></span><br><span class="line"></span><br><span class="line">            dropLabel-&gt;<span class="built_in">putpost</span>(i*<span class="number">6</span>+j,droplabels);</span><br><span class="line">            <span class="comment">//设置坐标信息</span></span><br><span class="line">            gridLayout-&gt;<span class="built_in">addWidget</span>(dropLabel, i, j);</span><br><span class="line">            <span class="comment">//加入</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设置拼图布局</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *double0=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    double0-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">0</span>]);</span><br><span class="line">    QHBoxLayout *double1=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    double1-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">1</span>]);</span><br><span class="line">    double1-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">2</span>]);</span><br><span class="line">    QHBoxLayout *double2=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    double2-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">3</span>]);</span><br><span class="line">    double2-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">4</span>]);</span><br><span class="line">    QHBoxLayout *double3=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    double3-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">5</span>]);</span><br><span class="line">    double3-&gt;<span class="built_in">addWidget</span>(uselabel[<span class="number">6</span>]);</span><br><span class="line">    <span class="comment">//分层次</span></span><br><span class="line"></span><br><span class="line">    QVBoxLayout *rivlayout = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">    rivlayout-&gt;<span class="built_in">setSpacing</span>(<span class="number">20</span>);</span><br><span class="line">    rivlayout-&gt;<span class="built_in">addLayout</span>(double0);</span><br><span class="line">    rivlayout-&gt;<span class="built_in">addLayout</span>(double1);</span><br><span class="line">    rivlayout-&gt;<span class="built_in">addLayout</span>(double2);</span><br><span class="line">    rivlayout-&gt;<span class="built_in">addLayout</span>(double3);</span><br><span class="line">    <span class="comment">//右侧垂直布局</span></span><br><span class="line"></span><br><span class="line">    QPushButton *back = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    back-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    start = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;开始&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    start-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    QPushButton *over = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;检查&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    over-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    inLevel = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;排行&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    inLevel-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    pullBack=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;后撤&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    pullBack-&gt;<span class="built_in">setFixedSize</span>(<span class="number">160</span>,<span class="number">80</span>);</span><br><span class="line">    help=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;提示&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    help-&gt;<span class="built_in">setFixedSize</span>(<span class="number">160</span>,<span class="number">80</span>);</span><br><span class="line">    tools=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;道具&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    tools-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    tools-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    <span class="comment">//按钮</span></span><br><span class="line"></span><br><span class="line">    time=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    time-&gt;<span class="built_in">setFixedSize</span>(<span class="number">320</span>,<span class="number">160</span>);</span><br><span class="line">    time-&gt;<span class="built_in">setText</span>(<span class="string">&quot;00:00:00&quot;</span>);</span><br><span class="line">    time-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: green;&quot;</span>);</span><br><span class="line">    time-&gt;<span class="built_in">setAlignment</span>(Qt::AlignCenter);</span><br><span class="line">    timer=<span class="keyword">new</span> <span class="built_in">QTimer</span>(<span class="keyword">this</span>);</span><br><span class="line">    nowtime = QDateTime::<span class="built_in">currentDateTime</span>();</span><br><span class="line">    <span class="comment">//计时器</span></span><br><span class="line"></span><br><span class="line">    backCounter=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    backCounter-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    backCounter-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    backCounter-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: green;&quot;</span>);</span><br><span class="line">    helpCounter=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    helpCounter-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    helpCounter-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">    helpCounter-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: green;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    menu=<span class="keyword">new</span> <span class="built_in">QGridLayout</span>();</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(back,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(start,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(over,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(inLevel,<span class="number">0</span>,<span class="number">3</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(pullBack,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(help,<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(backCounter,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(helpCounter,<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">    menu-&gt;<span class="built_in">addWidget</span>(tools,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//创建操作菜单</span></span><br><span class="line"></span><br><span class="line">    QHBoxLayout *interect=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    interect-&gt;<span class="built_in">addStretch</span>();</span><br><span class="line">    interect-&gt;<span class="built_in">addLayout</span>(gridLayout);</span><br><span class="line">    <span class="comment">//防止gridlabel出现空格</span></span><br><span class="line"></span><br><span class="line">    QVBoxLayout *lelayout=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">    lelayout-&gt;<span class="built_in">addLayout</span>(interect);</span><br><span class="line">    lelayout-&gt;<span class="built_in">addLayout</span>(menu);</span><br><span class="line">    lelayout-&gt;<span class="built_in">addWidget</span>(time);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建总的水平布局</span></span><br><span class="line">    QHBoxLayout *tohlayout = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将左侧网格布局和右侧拼图布局加入总的水平布局</span></span><br><span class="line">    tohlayout-&gt;<span class="built_in">addLayout</span>(lelayout);</span><br><span class="line">    tohlayout-&gt;<span class="built_in">addStretch</span>();</span><br><span class="line">    tohlayout-&gt;<span class="built_in">addLayout</span>(rivlayout);</span><br><span class="line">    tohlayout-&gt;<span class="built_in">addStretch</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(back, &amp;QPushButton::clicked, <span class="keyword">this</span>,[=]()</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">writeOut</span>();</span><br><span class="line">                emit map::<span class="built_in">back</span>();</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(start,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;map::pause_on);</span><br><span class="line">    <span class="comment">//返回按钮</span></span><br><span class="line">    <span class="built_in">connect</span>(timer, &amp;QTimer::timeout, <span class="keyword">this</span>, &amp;map::update);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(over,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;map::check);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">36</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">connect</span>(droplabels[i], &amp;DropLabel::back, <span class="keyword">this</span>,[=](<span class="type">int</span> a,<span class="type">int</span> b) &#123;</span><br><span class="line">            forState(a,b);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">connect</span>(pullBack,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;map::toBack);</span><br><span class="line">    <span class="built_in">connect</span>(help,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;map::helpMe);</span><br><span class="line">    <span class="built_in">connect</span>(inLevel,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;map::callLevel);</span><br><span class="line">    <span class="built_in">connect</span>(tools,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;map::callTools);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">map::~<span class="built_in">map</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(level!=<span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> level;</span><br><span class="line">    &#125;</span><br><span class="line">    level=<span class="literal">nullptr</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::readmap</span><span class="params">(<span class="type">int</span>* _map,<span class="type">int</span>*_solution)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        workmap[i]=_map[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        solution[i]=_solution[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::putmap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cleanBack</span>();</span><br><span class="line">    <span class="comment">//清空提示，回溯</span></span><br><span class="line">    start-&gt;<span class="built_in">setText</span>(<span class="string">&quot;开始&quot;</span>);</span><br><span class="line"></span><br><span class="line">    nowtime = QDateTime::<span class="built_in">currentDateTime</span>(); <span class="comment">// 确保nowtime是最新的当前时间</span></span><br><span class="line">    <span class="function">QTime <span class="title">t_time</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    time-&gt;<span class="built_in">setText</span>(t_time.<span class="built_in">toString</span>(<span class="string">&quot;mm:ss.zzz&quot;</span>));</span><br><span class="line">    <span class="comment">//设置时间标签为初始时间</span></span><br><span class="line"></span><br><span class="line">    state=<span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//当前开关状态</span></span><br><span class="line"></span><br><span class="line">    backCounter-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    helpCounter-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="comment">//计数器设置</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置图片</span></span><br><span class="line">    <span class="function">QPixmap <span class="title">map1</span><span class="params">(<span class="string">&quot;:/image/0t.png&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QPixmap <span class="title">map2</span><span class="params">(<span class="string">&quot;:/image/02t.png&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QPixmap <span class="title">map3</span><span class="params">(<span class="string">&quot;:/image/13t.png&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QPixmap <span class="title">map4</span><span class="params">(<span class="string">&quot;:/image/4t.png&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加图片和拼图到网格布局</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> index = i * <span class="number">6</span> + j;</span><br><span class="line">            DropLabel *dropLabel = droplabels[index];</span><br><span class="line">            QLabel *picLabel = piclabel[index];</span><br><span class="line">            <span class="comment">//二者对应的指针</span></span><br><span class="line"></span><br><span class="line">            dropLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="type">int</span> temp=workmap[index];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span>(temp)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                picLabel-&gt;<span class="built_in">setPixmap</span>(map1);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                picLabel-&gt;<span class="built_in">setPixmap</span>(map2);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                picLabel-&gt;<span class="built_in">setPixmap</span>(map3);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                picLabel-&gt;<span class="built_in">setPixmap</span>(map4);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//给36个图片</span></span><br><span class="line"></span><br><span class="line">            picLabel-&gt;<span class="built_in">setFixedSize</span>(<span class="number">80</span>,<span class="number">80</span>);</span><br><span class="line">            picLabel-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line">            gridLayout-&gt;<span class="built_in">addWidget</span>(picLabel, i, j);</span><br><span class="line">            dropLabel-&gt;<span class="built_in">raise</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (timer-&gt;<span class="built_in">isActive</span>()) &#123;</span><br><span class="line">        timer-&gt;<span class="built_in">stop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断计时器是否在工作</span></span><br><span class="line"></span><br><span class="line">    lasttime = QDateTime::<span class="built_in">currentDateTime</span>();</span><br><span class="line">    <span class="comment">// 重置暂停相关的时间记录</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">module</span>==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pullBack-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        <span class="comment">//回撤</span></span><br><span class="line">        help-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        <span class="comment">//提示</span></span><br><span class="line">        helpCounter-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        <span class="comment">//提示计数板</span></span><br><span class="line">        backCounter-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        <span class="comment">//回撤计数板</span></span><br><span class="line">        inLevel-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        tools-&gt;<span class="built_in">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">module</span>==<span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        inLevel-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        tools-&gt;<span class="built_in">hide</span>();</span><br><span class="line">        help-&gt;<span class="built_in">show</span>();</span><br><span class="line">        helpCounter-&gt;<span class="built_in">show</span>();</span><br><span class="line">        backCounter-&gt;<span class="built_in">show</span>();</span><br><span class="line">        pullBack-&gt;<span class="built_in">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        pullBack-&gt;<span class="built_in">show</span>();</span><br><span class="line">        inLevel-&gt;<span class="built_in">show</span>();</span><br><span class="line">        help-&gt;<span class="built_in">show</span>();</span><br><span class="line">        helpCounter-&gt;<span class="built_in">show</span>();</span><br><span class="line">        backCounter-&gt;<span class="built_in">show</span>();</span><br><span class="line">        tools-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//模式设置</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::pause_on</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(state==<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        lasttime = QDateTime::<span class="built_in">currentDateTime</span>(); <span class="comment">// 记录暂停时的时间</span></span><br><span class="line">        timer-&gt;<span class="built_in">stop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            droplabels[i]-&gt;<span class="built_in">setAcceptDrops</span>(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        state=<span class="literal">false</span>;</span><br><span class="line">        start-&gt;<span class="built_in">setText</span>(<span class="string">&quot;开始&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        timer-&gt;<span class="built_in">start</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            droplabels[i]-&gt;<span class="built_in">setAcceptDrops</span>(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        state=<span class="literal">true</span>;</span><br><span class="line">        start-&gt;<span class="built_in">setText</span>(<span class="string">&quot;暂停&quot;</span>);</span><br><span class="line">        qint64 elapsedPausedTime = lasttime.<span class="built_in">msecsTo</span>(QDateTime::<span class="built_in">currentDateTime</span>());</span><br><span class="line">        nowtime = nowtime.<span class="built_in">addMSecs</span>(elapsedPausedTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//根据当前状态修改是否能继续游戏</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::update</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    qint64 elapsedTime = nowtime.<span class="built_in">msecsTo</span>(QDateTime::<span class="built_in">currentDateTime</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将时间转换成字符串并设置给QLabel</span></span><br><span class="line">    <span class="function">QTime <span class="title">t_time</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    t_time = t_time.<span class="built_in">addMSecs</span>(elapsedTime);</span><br><span class="line">    time-&gt;<span class="built_in">setText</span>(t_time.<span class="built_in">toString</span>(<span class="string">&quot;mm:ss.zzz&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lasttime = QDateTime::<span class="built_in">currentDateTime</span>();</span><br><span class="line">    <span class="comment">// 记录暂停时的时间</span></span><br><span class="line"></span><br><span class="line">    timer-&gt;<span class="built_in">stop</span>();</span><br><span class="line">    <span class="comment">//暂停计时器</span></span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> end=<span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> empt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        empt=droplabels[i]-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>();</span><br><span class="line">        <span class="keyword">switch</span>(workmap[i])</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">if</span>(empt!=<span class="number">4</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                end=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span>(empt!=<span class="number">3</span>&amp;&amp;empt!=<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                end=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">if</span>(empt!=<span class="number">2</span>&amp;&amp;empt!=<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                end=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span>(empt!=<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                end=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        droplabels[i]-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(end==<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        dialog *mess1=<span class="keyword">new</span> <span class="built_in">dialog</span>();</span><br><span class="line">        mess1-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;没想到让你赢了&quot;</span>);</span><br><span class="line">        mess1-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        qint64 elapsedTime = nowtime.<span class="built_in">msecsTo</span>(QDateTime::<span class="built_in">currentDateTime</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将时间转换成字符串并设置给QLabel</span></span><br><span class="line">        <span class="function">QTime <span class="title">t_time</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        t_time = t_time.<span class="built_in">addMSecs</span>(elapsedTime);</span><br><span class="line"></span><br><span class="line">        now_time=t_time.<span class="built_in">toString</span>(<span class="string">&quot;mm:ss.zzz&quot;</span>);</span><br><span class="line">        <span class="comment">//准备工作完成</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">calculate</span>();</span><br><span class="line">        <span class="comment">//计算积分</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span>(<span class="keyword">module</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            nowUser[<span class="number">3</span>][nowIndex]=<span class="string">&#x27;Y&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="type">int</span> empt=nowUser[<span class="number">2</span>].<span class="built_in">toInt</span>();</span><br><span class="line">            empt++;</span><br><span class="line">            nowUser[<span class="number">2</span>]=QString::<span class="built_in">number</span>(empt);</span><br><span class="line">            <span class="comment">//通关信息</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//统计过关数和信息</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//统计分数和用户数据修改</span></span><br><span class="line">        <span class="keyword">if</span>(nowUser[<span class="number">0</span>]!=<span class="string">&quot;Null&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">switch</span>(<span class="keyword">module</span>)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">compare</span>();</span><br><span class="line">                <span class="comment">//修改关卡信息,积分榜</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                empt++;</span><br><span class="line">                nowUser[<span class="number">2</span>]=QString::<span class="built_in">number</span>(empt);</span><br><span class="line">                <span class="built_in">compare</span>();</span><br><span class="line">                <span class="comment">//计入排行榜</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//三个模式下的各自策略</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        dialog *mess2=<span class="keyword">new</span> <span class="built_in">dialog</span>();</span><br><span class="line">        mess2-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;呕吼失败辣&quot;</span>);</span><br><span class="line">        mess2-&gt;<span class="built_in">exec</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    state=<span class="literal">false</span>;</span><br><span class="line">    start-&gt;<span class="built_in">setText</span>(<span class="string">&quot;开始&quot;</span>);</span><br><span class="line">    <span class="comment">//开始重置</span></span><br><span class="line">    <span class="comment">//回溯</span></span><br><span class="line">    <span class="built_in">cleanBack</span>();</span><br><span class="line">    <span class="comment">// 重置当前时间显示</span></span><br><span class="line">    nowtime = QDateTime::<span class="built_in">currentDateTime</span>(); <span class="comment">// 确保nowtime是最新的当前时间</span></span><br><span class="line">    <span class="function">QTime <span class="title">t_time</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    time-&gt;<span class="built_in">setText</span>(t_time.<span class="built_in">toString</span>(<span class="string">&quot;mm:ss.zzz&quot;</span>));</span><br><span class="line">    <span class="comment">// 设置时间标签为初始时间</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::forState</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> post)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">module</span>==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    i--;</span><br><span class="line">    uselabel[i]-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    dropBack.<span class="built_in">push_back</span>(std::<span class="built_in">vector</span>&lt;QString&gt;(<span class="number">36</span>));</span><br><span class="line">    dragBack.<span class="built_in">push_back</span>(i);</span><br><span class="line">    helpInt[i]=post;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">36</span>;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        dropBack[dropBack.<span class="built_in">size</span>()<span class="number">-1</span>][j]=droplabels[j]-&gt;<span class="built_in">text</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> empt=dropBack.<span class="built_in">size</span>();</span><br><span class="line">    QString _empt=QString::<span class="built_in">number</span>(empt);</span><br><span class="line">    backCounter-&gt;<span class="built_in">setText</span>(_empt);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(helpInt[i]==solution[i])</span><br><span class="line">            a++;</span><br><span class="line">    &#125;</span><br><span class="line">    QString _empt1=QString::<span class="built_in">number</span>(a);</span><br><span class="line">    helpCounter-&gt;<span class="built_in">setText</span>(_empt1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::cleanBack</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dropBack.<span class="built_in">clear</span>();</span><br><span class="line">    dragBack.<span class="built_in">clear</span>();</span><br><span class="line">    now_back=<span class="number">0</span>;</span><br><span class="line">    now_help=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        helpInt[i]=<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        uselabel[i]-&gt;<span class="built_in">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    helpCounter-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    backCounter-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line"></span><br><span class="line">    fault=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::toBack</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString temp=backCounter-&gt;<span class="built_in">text</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> _temp=temp.<span class="built_in">toInt</span>();</span><br><span class="line">    _temp--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(_temp&gt;=<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fault++;</span><br><span class="line">        now_back++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            droplabels[i]-&gt;<span class="built_in">setText</span>(dropBack[_temp][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        uselabel[dragBack[_temp]]-&gt;<span class="built_in">show</span>();</span><br><span class="line">        temp=QString::<span class="built_in">number</span>(_temp);</span><br><span class="line">        backCounter-&gt;<span class="built_in">setText</span>(temp);</span><br><span class="line">        dropBack.<span class="built_in">pop_back</span>();</span><br><span class="line">        dragBack.<span class="built_in">pop_back</span>();</span><br><span class="line">        helpInt[_temp]=<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::helpMe</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(solution[i]!=helpInt[i]&amp;&amp;solution[i]!=<span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            dialog* temp=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> x=solution[i]/<span class="number">6</span>+<span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> y=solution[i]%<span class="number">6</span>+<span class="number">1</span>;</span><br><span class="line">            temp-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;第&quot;</span>+QString::<span class="built_in">number</span>(i+<span class="number">1</span>)+<span class="string">&quot;图片的坐标为：第&quot;</span>+QString::<span class="built_in">number</span>(x)+<span class="string">&quot;列，第&quot;</span>+QString::<span class="built_in">number</span>(y)+<span class="string">&quot;排&quot;</span>);</span><br><span class="line"></span><br><span class="line">            temp-&gt;<span class="built_in">exec</span>();</span><br><span class="line">            temp-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">            now_help++;</span><br><span class="line">            fault++;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dialog* temp=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line">    temp-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;快去交卷&quot;</span>);</span><br><span class="line">    temp-&gt;<span class="built_in">exec</span>();</span><br><span class="line">    <span class="comment">// temp-&gt;gameMode();</span></span><br><span class="line">    <span class="comment">// temp-&gt;show();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::setIn</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    nowIndex=i;</span><br><span class="line">    QString a=<span class="string">&quot;level&quot;</span>+QString::<span class="built_in">number</span>(i)+<span class="string">&quot;.bin&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(a)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    in&gt;&gt;*level;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::compare</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    level-&gt;<span class="built_in">liCheckLevel</span>(nowUser,now_time);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::callLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(nowUser[<span class="number">0</span>]==<span class="string">&quot;Null&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        dialog* tip=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line">        tip-&gt;<span class="built_in">setMessage</span>(<span class="string">&quot;游客不能访问排行榜&quot;</span>);</span><br><span class="line">        tip-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dialog *Dialog=<span class="keyword">new</span> <span class="built_in">dialog</span>();</span><br><span class="line">    Dialog-&gt;<span class="built_in">setLevel</span>(*level,horHeaders);</span><br><span class="line">    Dialog-&gt;<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::humanMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;basemap.bin&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::Append))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Failed to open file.&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QDataStream <span class="title">ifs</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ifs&lt;&lt;droplabels[i]-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ifs&lt;&lt;helpInt[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;完成&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::nullMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        workmap[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        helpInt[i]=<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::popLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    inLevel-&gt;<span class="built_in">hide</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::setModule</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">module</span>=n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::calculate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a = now_time.<span class="built_in">mid</span>(<span class="number">0</span>, <span class="number">2</span>).<span class="built_in">toInt</span>();  <span class="comment">// 提取前两个字符</span></span><br><span class="line">    <span class="type">int</span> b= now_time.<span class="built_in">mid</span>(<span class="number">3</span>, <span class="number">2</span>).<span class="built_in">toInt</span>();  <span class="comment">// 提取中间两个字符，从索引3开始</span></span><br><span class="line">    <span class="type">int</span> c= now_time.<span class="built_in">mid</span>(<span class="number">6</span>, <span class="number">3</span>).<span class="built_in">toInt</span>();</span><br><span class="line">    <span class="type">double</span> total=a+b*<span class="number">0.01</span>+c*<span class="number">0.001</span>;</span><br><span class="line">    <span class="type">int</span> score=nowUser[<span class="number">4</span>].<span class="built_in">toInt</span>();;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(<span class="keyword">module</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span>(nowUser[<span class="number">3</span>][nowIndex]!=<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            score-=fault*<span class="number">20</span>;</span><br><span class="line">            score+=<span class="number">100</span>;</span><br><span class="line">            <span class="keyword">if</span>(total&lt;<span class="number">3</span>)</span><br><span class="line">                score+=<span class="number">300</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                score+=<span class="number">900</span>/total;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        score-=fault*<span class="number">30</span>;</span><br><span class="line">        <span class="keyword">if</span>(total&lt;<span class="number">1</span>)</span><br><span class="line">            score+=<span class="number">400</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            score+=<span class="number">1000</span>/total;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        score+=<span class="number">100</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        score+=<span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    nowUser[<span class="number">4</span>]=QString::<span class="built_in">number</span>(score);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::callTools</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dialog* gametool=<span class="keyword">new</span> <span class="built_in">dialog</span>(<span class="keyword">this</span>);</span><br><span class="line">    gametool-&gt;<span class="built_in">gameMode</span>();</span><br><span class="line">    gametool-&gt;<span class="built_in">show</span>();</span><br><span class="line">    tools-&gt;<span class="built_in">hide</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">map::writeOut</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">module</span>==<span class="number">1</span>||<span class="keyword">module</span>==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        QString a=<span class="string">&quot;level&quot;</span>+QString::<span class="built_in">number</span>(nowIndex)+<span class="string">&quot;.bin&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function">QFile <span class="title">file</span><span class="params">(a)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::WriteOnly))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;无法打开文件&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function">QDataStream <span class="title">out</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">        out&lt;&lt;*level;</span><br><span class="line"></span><br><span class="line">        file.<span class="built_in">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-7"><a href="#介绍-7" class="headerlink" title="介绍"></a>介绍</h2><p><img src="\img\image-20240525173019553.png" alt="image-20240525173019553"><br>在这个页面中，用户对图片进行拖拽，左侧的控件检测拖拽，给出反应。此外，还有回溯，提示，返回，排行榜，检查，计时器等功能。</p>
<h1 id="ranking"><a href="#ranking" class="headerlink" title="ranking"></a>ranking</h1><h2 id="ranking-h"><a href="#ranking-h" class="headerlink" title="ranking.h"></a>ranking.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> RANKING_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RANKING_H</span></span><br><span class="line">\</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDataStream&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ranking</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">friend</span> QDataStream&amp; <span class="keyword">operator</span>&gt;&gt;(QDataStream&amp; in, ranking&amp; p);</span><br><span class="line">    <span class="keyword">friend</span> QDataStream&amp; <span class="keyword">operator</span>&lt;&lt;(QDataStream&amp; out, ranking&amp; p);</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ranking</span>( <span class="type">int</span>);</span><br><span class="line">    ~<span class="built_in">ranking</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">toCheckLevel</span><span class="params">(std::vector&lt;QString&gt;&amp;)</span></span>;</span><br><span class="line">    <span class="comment">//总榜对比</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">liCheckLevel</span><span class="params">(std::vector&lt;QString&gt;&amp;,QString&amp;)</span></span>;</span><br><span class="line">    <span class="comment">//子榜对比</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">reData</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回规模</span></span><br><span class="line">    std::vector&lt;std::vector&lt;QString&gt;&gt; <span class="built_in">reVector</span>();</span><br><span class="line">    <span class="comment">//返回数组</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//清空</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> datas;</span><br><span class="line">    std::vector&lt;std::vector&lt;QString&gt;&gt; levelOnes;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// RANKING_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ranking-cpp"><a href="#ranking-cpp" class="headerlink" title="ranking.cpp"></a>ranking.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ranking.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">ranking::<span class="built_in">ranking</span>(<span class="type">const</span> <span class="type">int</span> a)</span><br><span class="line">&#123;</span><br><span class="line">    datas=a;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        levelOnes.<span class="built_in">push_back</span>(std::<span class="built_in">vector</span>&lt;QString&gt;(a,<span class="string">&quot;&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QDataStream&amp; <span class="keyword">operator</span>&gt;&gt;(QDataStream&amp; in, ranking&amp; p)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;p.datas;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            in&gt;&gt;p.levelOnes[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QDataStream&amp; <span class="keyword">operator</span>&lt;&lt;(QDataStream&amp; out,ranking&amp; p)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;p.datas;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            out&lt;&lt;p.levelOnes[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ranking::toCheckLevel</span><span class="params">(std::vector&lt;QString&gt;&amp;nowUser)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">ranking <span class="title">empt</span><span class="params">(<span class="number">4</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> index=<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">9</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        empt.levelOnes[i][<span class="number">0</span>]=<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>];</span><br><span class="line">        <span class="comment">//名称</span></span><br><span class="line">        empt.levelOnes[i][<span class="number">1</span>]=<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">1</span>];</span><br><span class="line">        <span class="comment">//关卡数目</span></span><br><span class="line">        empt.levelOnes[i][<span class="number">2</span>]=<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">2</span>];</span><br><span class="line">        <span class="comment">//六关情况</span></span><br><span class="line">        empt.levelOnes[i][<span class="number">3</span>]=<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">3</span>];</span><br><span class="line">        <span class="comment">//积分榜</span></span><br><span class="line"></span><br><span class="line">        index=i;</span><br><span class="line">        <span class="keyword">if</span>(nowUser[<span class="number">4</span>]&lt;empt.levelOnes[i][<span class="number">3</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            index=i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获得排行</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;<span class="number">10</span>&amp;&amp;j&lt;<span class="number">10</span>;i++,j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i==index)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>]=nowUser[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">1</span>]=nowUser[<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">2</span>]=nowUser[<span class="number">3</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">3</span>]=nowUser[<span class="number">4</span>];</span><br><span class="line">            i++;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>]=empt.levelOnes[j][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">1</span>]=empt.levelOnes[j][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">2</span>]=empt.levelOnes[j][<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">3</span>]=empt.levelOnes[j][<span class="number">3</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ranking::liCheckLevel</span><span class="params">(std::vector&lt;QString&gt;&amp;nowUser,QString &amp;now_time)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="function">ranking <span class="title">empt</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> index=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>]==<span class="string">&quot;&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            index=i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,k=<span class="number">0</span>;i&lt;index&amp;&amp;k&lt;index;i++,k++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">1</span>||<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">1</span>]&lt;now_time)</span><br><span class="line">        &#123;</span><br><span class="line">            empt.levelOnes[i][<span class="number">0</span>]=<span class="keyword">this</span>-&gt;levelOnes[k][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">            empt.levelOnes[i][<span class="number">1</span>]=<span class="keyword">this</span>-&gt;levelOnes[k][<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            j=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            empt.levelOnes[i][<span class="number">0</span>]=nowUser[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">            empt.levelOnes[i][<span class="number">1</span>]=now_time;</span><br><span class="line">            k--;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(index!=<span class="number">-1</span>&amp;&amp;j==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;levelOnes[index][<span class="number">0</span>]=nowUser[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">this</span>-&gt;levelOnes[index][<span class="number">1</span>]=now_time;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>]==<span class="string">&quot;&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>]=empt.levelOnes[i][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">1</span>]=empt.levelOnes[i][<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">0</span>]=empt.levelOnes[i][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">this</span>-&gt;levelOnes[i][<span class="number">1</span>]=empt.levelOnes[i][<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ranking::reData</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> datas;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::vector&lt;std::vector&lt;QString&gt;&gt; ranking::<span class="built_in">reVector</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> levelOnes;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ranking::~<span class="built_in">ranking</span>()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ranking::clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;datas;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            levelOnes[i][j]=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-8"><a href="#介绍-8" class="headerlink" title="介绍"></a>介绍</h2><p>这个类用于传递排行榜，根据传入的QStringlist和数字自动开排行榜。示例之前已给出</p>
<h1 id="dialog"><a href="#dialog" class="headerlink" title="dialog"></a>dialog</h1><h2 id="dialog-h"><a href="#dialog-h" class="headerlink" title="dialog.h"></a>dialog.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> DIALOG_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DIALOG_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPixmap&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTableWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTableWidgetItem&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLineEdit&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ranking.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;draglabel.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">dialog</span> : <span class="keyword">public</span> QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">dialog</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line">    <span class="comment">//初始构造</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setLevel</span><span class="params">(<span class="type">const</span> ranking,QStringList)</span></span>;</span><br><span class="line">    <span class="comment">//排行榜</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setMessage</span><span class="params">(QString)</span></span>;</span><br><span class="line">    <span class="comment">//显示消息</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">returnout</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//返回</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">gameMode</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//游戏模式</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getMap</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//获得玩家地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">check</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//检查地图</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readUser</span><span class="params">(std::vector&lt;std::vector&lt;QString&gt;&gt;&amp;,std::vector&lt;QString&gt;&amp;)</span></span>;</span><br><span class="line">    <span class="comment">//读取游客模式的账号和密码</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">checkLog</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//检查末尾密码</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">outData</span><span class="params">(<span class="type">int</span>*)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLineEdit* workMap;</span><br><span class="line">    QLineEdit* account;</span><br><span class="line">    QLineEdit* password;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// DIALOG_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="dialog-cpp"><a href="#dialog-cpp" class="headerlink" title="dialog.cpp"></a>dialog.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">dialog::<span class="built_in">dialog</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QDialog</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::setLevel</span><span class="params">( ranking level,QStringList horHeaders)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QStringList verHeaders;</span><br><span class="line">    verHeaders &lt;&lt; <span class="string">&quot;玩家序列 1&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 2&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 3&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 4&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 5&quot;</span></span><br><span class="line">               &lt;&lt; <span class="string">&quot;玩家序列 6&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 7&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 8&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 9&quot;</span> &lt;&lt; <span class="string">&quot;玩家序列 10&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setFixedSize</span>(<span class="number">700</span>,<span class="number">600</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 QTableWidget</span></span><br><span class="line">    QTableWidget *levelTable = <span class="keyword">new</span> <span class="built_in">QTableWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    levelTable-&gt;<span class="built_in">setFixedSize</span>(<span class="number">700</span>,<span class="number">400</span>);</span><br><span class="line">    levelTable-&gt;<span class="built_in">setRowCount</span>(<span class="number">10</span>); <span class="comment">// 设置行数</span></span><br><span class="line">    levelTable-&gt;<span class="built_in">setColumnCount</span>(level.<span class="built_in">reData</span>()); <span class="comment">// 设置列数</span></span><br><span class="line">    levelTable-&gt;<span class="built_in">setVerticalHeaderLabels</span>(verHeaders);</span><br><span class="line">    levelTable-&gt;<span class="built_in">setHorizontalHeaderLabels</span>(horHeaders);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置每个单元格的大小</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        levelTable-&gt;<span class="built_in">setRowHeight</span>(i, <span class="number">70</span>); <span class="comment">// 设置第 i 行的高度为 40 像素</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; level.<span class="built_in">reData</span>(); j++) &#123;</span><br><span class="line">        levelTable-&gt;<span class="built_in">setColumnWidth</span>(j, <span class="number">130</span>); <span class="comment">// 设置第 j 列的宽度为 100 像素</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::vector&lt;std::vector&lt;QString&gt;&gt; temp=level.<span class="built_in">reVector</span>();</span><br><span class="line">    <span class="comment">// 填充表格数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; level.<span class="built_in">reData</span>(); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            QTableWidgetItem *item = <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(temp[i][j]);</span><br><span class="line">            item-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter);</span><br><span class="line">            levelTable-&gt;<span class="built_in">setItem</span>(i, j, item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建按钮</span></span><br><span class="line">    QPushButton *_return=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *layout=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(levelTable);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(_return);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(_return,&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;dialog::returnout);</span><br><span class="line">    <span class="comment">// 将表格添加到主窗口布局中</span></span><br><span class="line">    <span class="built_in">setLayout</span>(layout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::returnout</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::setMessage</span><span class="params">(QString a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setFixedSize</span>(<span class="number">200</span>,<span class="number">300</span>);</span><br><span class="line"></span><br><span class="line">    QLabel *tital=<span class="keyword">new</span> <span class="built_in">QLabel</span>(a,<span class="keyword">this</span>);</span><br><span class="line">    tital-&gt;<span class="built_in">setFixedSize</span>(<span class="number">200</span>,<span class="number">200</span>);</span><br><span class="line">    tital-&gt;<span class="built_in">setAlignment</span>(Qt::AlignCenter);</span><br><span class="line"></span><br><span class="line">    QPushButton *set=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;确认&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *layout=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(tital);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(set,&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;dialog::returnout);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setLayout</span>(layout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::gameMode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setFixedSize</span>(<span class="number">200</span>,<span class="number">300</span>);</span><br><span class="line"></span><br><span class="line">    DragLabel *pic=<span class="keyword">new</span> <span class="built_in">DragLabel</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">QPixmap <span class="title">map4</span><span class="params">(<span class="string">&quot;:/image/1.png&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    pic-&gt;<span class="built_in">setFixedSize</span>(<span class="number">200</span>,<span class="number">200</span>);</span><br><span class="line">    pic-&gt;<span class="built_in">setAlignment</span>(Qt::AlignCenter);</span><br><span class="line">    pic-&gt;<span class="built_in">setPixmap</span>(map4);</span><br><span class="line">    pic-&gt;<span class="built_in">put_text</span>(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">    pic-&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    QPushButton *set=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;确认&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *layout=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">    <span class="comment">// layout-&gt;addWidget(pic);</span></span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(set,&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;dialog::returnout);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setLayout</span>(layout);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::getMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setFixedSize</span>(<span class="number">600</span>,<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">    workMap=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="keyword">this</span>);</span><br><span class="line">    workMap-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;在此输入地图&quot;</span>);</span><br><span class="line">    QLabel *number=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    number-&gt;<span class="built_in">setText</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line"></span><br><span class="line">    QPushButton *start=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;完成&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    start-&gt;<span class="built_in">hide</span>();</span><br><span class="line">    QPushButton *_return=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;返回&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QHBoxLayout *layout1=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    layout1-&gt;<span class="built_in">addWidget</span>(start);</span><br><span class="line">    layout1-&gt;<span class="built_in">addWidget</span>(_return);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *layout2=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    layout2-&gt;<span class="built_in">addWidget</span>(number);</span><br><span class="line">    layout2-&gt;<span class="built_in">addWidget</span>(workMap);</span><br><span class="line">    layout2-&gt;<span class="built_in">addLayout</span>(layout1);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(_return,&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;dialog::returnout);</span><br><span class="line">    <span class="built_in">connect</span>(workMap,&amp;QLineEdit::textEdited,<span class="keyword">this</span>,[number](<span class="type">const</span> QString &amp;text)</span><br><span class="line">            &#123;</span><br><span class="line">        number-&gt;<span class="built_in">setText</span>(<span class="string">&quot;已输入 &quot;</span> + QString::<span class="built_in">number</span>(text.<span class="built_in">length</span>()));</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(workMap,&amp;QLineEdit::textEdited,<span class="keyword">this</span>,[start](<span class="type">const</span> QString &amp;text)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(text.<span class="built_in">length</span>()==<span class="number">36</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                start-&gt;<span class="built_in">show</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                start-&gt;<span class="built_in">hide</span>();</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(start,&amp;QPushButton::clicked, <span class="keyword">this</span>,&amp;dialog::check);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setLayout</span>(layout2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString number=workMap-&gt;<span class="built_in">text</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(number[i]!=<span class="string">&#x27;1&#x27;</span>&amp;&amp;number[i]!=<span class="string">&#x27;2&#x27;</span>&amp;&amp;number[i]!=<span class="string">&#x27;3&#x27;</span>&amp;&amp;number[i]!=<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            workMap-&gt;<span class="built_in">clear</span>();</span><br><span class="line">            workMap-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;输入无效&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> workmap[<span class="number">36</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        workmap[i]=number[i].<span class="built_in">digitValue</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">emit <span class="title">outData</span><span class="params">(workmap)</span></span>;</span><br><span class="line">    <span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dialog::readUser</span><span class="params">(std::vector&lt;std::vector&lt;QString&gt;&gt;&amp;users,std::vector&lt;QString&gt;&amp; user)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setFixedSize</span>(<span class="number">600</span>,<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">    account=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="keyword">this</span>);</span><br><span class="line">    password=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;在此输入账号&quot;</span>);</span><br><span class="line">    password-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;在此输入密码&quot;</span>);</span><br><span class="line"></span><br><span class="line">    QPushButton *start=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;完成&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    QPushButton *_return=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;结束&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QHBoxLayout *layout1=<span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">    layout1-&gt;<span class="built_in">addWidget</span>(start);</span><br><span class="line">    layout1-&gt;<span class="built_in">addWidget</span>(_return);</span><br><span class="line"></span><br><span class="line">    QVBoxLayout *layout2=<span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    layout2-&gt;<span class="built_in">addWidget</span>(account);</span><br><span class="line">    layout2-&gt;<span class="built_in">addWidget</span>(password);</span><br><span class="line">    layout2-&gt;<span class="built_in">addLayout</span>(layout1);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(_return,&amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;dialog::returnout);</span><br><span class="line">    <span class="built_in">connect</span>(start, &amp;QPushButton::clicked, <span class="keyword">this</span>, [<span class="keyword">this</span>, &amp;users, &amp;user]() &#123;</span><br><span class="line">        QString enteredAccount = account-&gt;<span class="built_in">text</span>();</span><br><span class="line">        QString enteredPassword = password-&gt;<span class="built_in">text</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(enteredAccount==<span class="string">&quot;&quot;</span>)</span><br><span class="line">            account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;无效账号&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;users.<span class="built_in">size</span>();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (users[i][<span class="number">0</span>]== enteredAccount)</span><br><span class="line">            &#123;</span><br><span class="line">                account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;账号重复&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        user[<span class="number">0</span>]=enteredAccount;</span><br><span class="line">        user[<span class="number">1</span>]=enteredPassword;</span><br><span class="line">        account-&gt;<span class="built_in">setPlaceholderText</span>(<span class="string">&quot;账号创建完毕，点击结束退出&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">setLayout</span>(layout2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-9"><a href="#介绍-9" class="headerlink" title="介绍"></a>介绍</h2><p>这个类主要用于弹出提示词，小道具，小提示等不值得被做成单个界面的东西</p>
<h1 id="droplabel"><a href="#droplabel" class="headerlink" title="droplabel"></a>droplabel</h1><h2 id="draoplabel-h"><a href="#draoplabel-h" class="headerlink" title="draoplabel.h"></a>draoplabel.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> DROPLABEL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DROPLABEL_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDrag&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMimeData&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMouseEvent&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGridLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGraphicsDropShadowEffect&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DropLabel</span> : <span class="keyword">public</span> QLabel</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">DropLabel</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putpost</span><span class="params">(<span class="type">int</span>,std::vector&lt;DropLabel*&gt;)</span></span>;</span><br><span class="line">    <span class="comment">//设置坐标，并传入网格的指针</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">findlabel</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="comment">//衍生到其他label</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">checkchar</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//1-&gt;2-&gt;3-&gt;4</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dragEnterEvent</span><span class="params">(QDragEnterEvent *event)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">//判断是否要接收这个拖拽</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dropEvent</span><span class="params">(QDropEvent *event)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">//接收之后的操作</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">back</span><span class="params">(<span class="type">int</span>,<span class="type">int</span>)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> post;<span class="comment">//位置信息</span></span><br><span class="line">    std::vector&lt;DropLabel*&gt; droplabel;<span class="comment">//指针</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// DROPLABEL_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="droplabel-cpp"><a href="#droplabel-cpp" class="headerlink" title="droplabel.cpp"></a>droplabel.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DropLabel.h&quot;</span></span></span><br><span class="line">DropLabel::<span class="built_in">DropLabel</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QLabel</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">setAcceptDrops</span>(<span class="literal">false</span>); <span class="comment">// 接受拖放事件</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DropLabel::dragEnterEvent</span><span class="params">(QDragEnterEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString droppedText = event-&gt;<span class="built_in">mimeData</span>()-&gt;<span class="built_in">text</span>();</span><br><span class="line">    <span class="type">int</span> empt=droppedText.<span class="built_in">toInt</span>();</span><br><span class="line">    <span class="keyword">switch</span>(empt)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> (post % <span class="number">6</span> &lt; <span class="number">3</span>&amp;&amp;post/<span class="number">6</span>&lt;<span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: blue;&quot;</span>);</span><br><span class="line">            event-&gt;<span class="built_in">acceptProposedAction</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: red;&quot;</span>);</span><br><span class="line">            event-&gt;<span class="built_in">ignore</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> (post % <span class="number">6</span> &lt; <span class="number">4</span>&amp;&amp;post/<span class="number">6</span>&lt;<span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: blue;&quot;</span>);</span><br><span class="line">            event-&gt;<span class="built_in">acceptProposedAction</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: red;&quot;</span>);</span><br><span class="line">            event-&gt;<span class="built_in">ignore</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">if</span> (post % <span class="number">6</span> &lt; <span class="number">5</span>&amp;&amp;post/<span class="number">6</span>&lt;<span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: blue;&quot;</span>);</span><br><span class="line">            event-&gt;<span class="built_in">acceptProposedAction</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: red;&quot;</span>);</span><br><span class="line">            event-&gt;<span class="built_in">ignore</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: blue;&quot;</span>);</span><br><span class="line">        event-&gt;<span class="built_in">acceptProposedAction</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//能写入的一定是合法的</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DropLabel::dropEvent</span><span class="params">(QDropEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString droppedText = event-&gt;<span class="built_in">mimeData</span>()-&gt;<span class="built_in">text</span>();</span><br><span class="line">    <span class="type">int</span> empt=droppedText.<span class="built_in">toInt</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">emit <span class="title">DropLabel::back</span><span class="params">(empt,post)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        droplabel[i]-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;color: green;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(empt)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>,posi=post; i &lt; <span class="number">4</span>; i++,posi+=<span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">findlabel</span>(posi);</span><br><span class="line">            <span class="built_in">findlabel</span>(posi+<span class="number">1</span>);</span><br><span class="line">            <span class="built_in">findlabel</span>(posi+<span class="number">2</span>);</span><br><span class="line">            <span class="built_in">findlabel</span>(posi+<span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>,posi=post; i &lt; <span class="number">3</span>; i++,posi+=<span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">findlabel</span>(posi);</span><br><span class="line">            <span class="built_in">findlabel</span>(posi+<span class="number">1</span>);</span><br><span class="line">            <span class="built_in">findlabel</span>(posi+<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>,posi=post; i &lt; <span class="number">2</span>; i++,posi+=<span class="number">6</span>) <span class="comment">// 16格有点多，循环吧</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">findlabel</span>(posi);</span><br><span class="line">            <span class="built_in">findlabel</span>(posi+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="built_in">findlabel</span>(post);</span><br><span class="line">        event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DropLabel::putpost</span><span class="params">(<span class="type">int</span> i,std::vector&lt;DropLabel*&gt; labels)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    post=i;</span><br><span class="line">    droplabel=labels;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DropLabel::findlabel</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DropLabel *dropLabel =droplabel[i];<span class="comment">// 转换为DropLabel</span></span><br><span class="line">    dropLabel-&gt;<span class="built_in">checkchar</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DropLabel::checkchar</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString a=<span class="built_in">text</span>();</span><br><span class="line">    <span class="type">int</span> b=a.<span class="built_in">toInt</span>();</span><br><span class="line">    b++;</span><br><span class="line">    a=QString::<span class="built_in">number</span>(b);</span><br><span class="line">    <span class="built_in">setText</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-10"><a href="#介绍-10" class="headerlink" title="介绍"></a>介绍</h2><p>map左侧的6*6的区域，接收右侧图片的拖拽，并显示动态数字</p>
<h1 id="draglabel"><a href="#draglabel" class="headerlink" title="draglabel"></a>draglabel</h1><h2 id="draglabel-h"><a href="#draglabel-h" class="headerlink" title="draglabel.h"></a>draglabel.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> DRAGLABEL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DRAGLABEL_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMouseEvent&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDrag&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMimeData&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGraphicsDropShadowEffect&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGraphicsPixmapItem&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGraphicsScene&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPainter&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DragLabel</span> : <span class="keyword">public</span> QLabel</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">DragLabel</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">put_text</span><span class="params">(QString)</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mousePressEvent</span><span class="params">(QMouseEvent *event)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mouseMoveEvent</span><span class="params">(QMouseEvent *event)</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QString text;</span><br><span class="line">    QPoint dragStartPos;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// DRAGLABEL_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="draglabel-cpp"><a href="#draglabel-cpp" class="headerlink" title="draglabel.cpp"></a>draglabel.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DragLabel.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">DragLabel::<span class="built_in">DragLabel</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QLabel</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">setMouseTracking</span>(<span class="literal">true</span>); <span class="comment">// 跟踪鼠标移动</span></span><br><span class="line">    <span class="built_in">setCursor</span>(Qt::OpenHandCursor); <span class="comment">// 设置手型光标</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DragLabel::mousePressEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event-&gt;<span class="built_in">button</span>() == Qt::LeftButton) &#123;</span><br><span class="line">        dragStartPos = event-&gt;<span class="built_in">pos</span>(); <span class="comment">// 记录鼠标按下时的位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    QLabel::<span class="built_in">mousePressEvent</span>(event);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DragLabel::put_text</span><span class="params">(QString t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    text=t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DragLabel::mouseMoveEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event-&gt;<span class="built_in">buttons</span>() &amp; Qt::LeftButton) &#123; <span class="comment">// 检查鼠标左键是否被按下</span></span><br><span class="line">        QPoint diff = event-&gt;<span class="built_in">pos</span>() - dragStartPos; <span class="comment">// 计算鼠标移动的距离</span></span><br><span class="line">        <span class="keyword">if</span> (diff.<span class="built_in">manhattanLength</span>() &lt; QApplication::<span class="built_in">startDragDistance</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span>; <span class="comment">// 如果移动距离小于启动拖动的距离，则不执行拖动</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//第一部分结束</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建拖动图像并应用虚化效果</span></span><br><span class="line">        QPixmap originalPixmap = <span class="built_in">pixmap</span>(Qt::ReturnByValue);</span><br><span class="line">        QGraphicsScene scene;</span><br><span class="line">        QGraphicsPixmapItem *pixmapItem = scene.<span class="built_in">addPixmap</span>(originalPixmap);</span><br><span class="line">        QGraphicsBlurEffect *blurEffect = <span class="keyword">new</span> QGraphicsBlurEffect;</span><br><span class="line">        blurEffect-&gt;<span class="built_in">setBlurRadius</span>(<span class="number">0</span>); <span class="comment">// 调整此值以改变虚化程度</span></span><br><span class="line"></span><br><span class="line">        pixmapItem-&gt;<span class="built_in">setGraphicsEffect</span>(blurEffect);</span><br><span class="line">        <span class="comment">//将模糊效果（blurEffect）应用于 pixmapItem，从而将其模糊化。</span></span><br><span class="line"></span><br><span class="line">        <span class="function">QImage <span class="title">blurredImage</span><span class="params">(scene.width(), scene.height(), QImage::Format_ARGB32)</span></span>;</span><br><span class="line">        <span class="function">QPainter <span class="title">painter</span><span class="params">(&amp;blurredImage)</span></span>;</span><br><span class="line">        scene.<span class="built_in">render</span>(&amp;painter);</span><br><span class="line">        <span class="comment">//将模糊场景捕获为图像</span></span><br><span class="line"></span><br><span class="line">        QPixmap blurredPixmap = QPixmap::<span class="built_in">fromImage</span>(blurredImage);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 实现拖动逻辑</span></span><br><span class="line">        QDrag *drag = <span class="keyword">new</span> <span class="built_in">QDrag</span>(<span class="keyword">this</span>);</span><br><span class="line">        QMimeData *mimeData = <span class="keyword">new</span> QMimeData;</span><br><span class="line">        mimeData-&gt;<span class="built_in">setText</span>(text); <span class="comment">// 将标签的文本作为MIME数据</span></span><br><span class="line">        drag-&gt;<span class="built_in">setMimeData</span>(mimeData);</span><br><span class="line">        drag-&gt;<span class="built_in">setPixmap</span>(blurredPixmap); <span class="comment">// 使用虚化后的图像</span></span><br><span class="line">        drag-&gt;<span class="built_in">setHotSpot</span>(<span class="built_in">QPoint</span>(<span class="number">0</span>, <span class="number">0</span>)); <span class="comment">// 热区设置在图像的左上角，让图像跟随鼠标箭头</span></span><br><span class="line">        drag-&gt;<span class="built_in">exec</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    QLabel::<span class="built_in">mouseMoveEvent</span>(event);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-11"><a href="#介绍-11" class="headerlink" title="介绍"></a>介绍</h2><p>map中右侧的可拖拽的图片。</p>
<h1 id="main"><a href="#main" class="headerlink" title="main"></a>main</h1><h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;initial.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextStream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStackedWidget&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">    <span class="function">QApplication <span class="title">app</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    initial Start;</span><br><span class="line">    QDialogButtonBox::<span class="built_in">connect</span>(&amp;app, &amp;QApplication::aboutToQuit, &amp;Start,&amp;initial::store);</span><br><span class="line">    Start.<span class="built_in">show</span>();</span><br><span class="line">    <span class="keyword">return</span> app.<span class="built_in">exec</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取应用数据目录</span></span><br><span class="line">    <span class="comment">// QFile file(&quot;log.bin&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// QDataStream in(&amp;file);</span></span><br><span class="line">    <span class="comment">// if (!file.open(QIODevice::WriteOnly))</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//     qDebug() &lt;&lt; &quot;无法打开文件&quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// int i=0;</span></span><br><span class="line">    <span class="comment">// in&lt;&lt;i;</span></span><br><span class="line">    <span class="comment">// file.close();</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="介绍-12"><a href="#介绍-12" class="headerlink" title="介绍"></a>介绍</h2><p>存在一个槽函数，用于在程序退出后存储所有的信息和询问游客是否注册</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.lafael.top">surtr lafael</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.lafael.top/2024/05/25/%E5%AE%9E%E8%AE%AD1-1/">https://www.lafael.top/2024/05/25/%E5%AE%9E%E8%AE%AD1-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.lafael.top" target="_blank">Hephaestus</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/c/">c++</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/832c7ac5ccce17309c24a1ae9c06c3e6.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/05/25/lk-m1/" title="lk_m1"><img class="cover" src="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/-47791e0cbbb2470.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">lk_m1</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/28/%E5%AE%9E%E8%AE%AD0-3/" title="实训0-3"><img class="cover" src="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/0a67ad032fe2ede23b17990ced7b77d4.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">实训0-3</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/06/06/2017c%E4%B8%AD/" title="2017c中"><img class="cover" src="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/1558433098686.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-06</div><div class="title">2017c中</div></div></a></div><div><a href="/2024/06/06/2016%E8%8B%B1/" title="2016英"><img class="cover" src="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/8be1b3f5ec592dbbea5166eb62a4454a499d5965_raw.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-06</div><div class="title">2016英</div></div></a></div><div><a href="/2024/06/02/2022c%E4%B8%AD/" title="2022c中"><img class="cover" src="https://raw.githubusercontent.com/lafaeier/PicBed/image/img/8bb6609da04577c7e42913bc9b6f5442a6fc9689_raw.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-02</div><div class="title">2022c中</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">surtr lafael</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lafaeier"><i class="fab fa-github"></i><span>今四,50,喜奔。</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lafaeier" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:hamiltonlafael@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">(阴暗的爬行)陆地,太过干燥,无鳞,离群的同胞,我呼唤你,带你归巢(嘶吼)。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#widget"><span class="toc-number">1.</span> <span class="toc-text">widget</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#widget-h"><span class="toc-number">1.1.</span> <span class="toc-text">widget.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#widget-cpp"><span class="toc-number">1.2.</span> <span class="toc-text">widget.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#initial"><span class="toc-number">2.</span> <span class="toc-text">initial</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#initial-h"><span class="toc-number">2.1.</span> <span class="toc-text">initial.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#initial-cpp"><span class="toc-number">2.2.</span> <span class="toc-text">initial.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="toc-number">2.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#start"><span class="toc-number">3.</span> <span class="toc-text">start</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#start-h"><span class="toc-number">3.1.</span> <span class="toc-text">start.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#start-cpp"><span class="toc-number">3.2.</span> <span class="toc-text">start.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">3.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#game"><span class="toc-number">4.</span> <span class="toc-text">game</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#game-h"><span class="toc-number">4.1.</span> <span class="toc-text">game.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#game-cpp"><span class="toc-number">4.2.</span> <span class="toc-text">game.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">4.3.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#base"><span class="toc-number">4.4.</span> <span class="toc-text">base</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base-h"><span class="toc-number">4.4.1.</span> <span class="toc-text">base.h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base-cpp"><span class="toc-number">4.4.2.</span> <span class="toc-text">base.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-4"><span class="toc-number">4.4.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hard"><span class="toc-number">4.5.</span> <span class="toc-text">hard</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hard-h"><span class="toc-number">4.5.1.</span> <span class="toc-text">hard.h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hard-cpp"><span class="toc-number">4.5.2.</span> <span class="toc-text">hard.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-5"><span class="toc-number">4.5.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#storage"><span class="toc-number">4.6.</span> <span class="toc-text">storage</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#storage-h"><span class="toc-number">4.6.1.</span> <span class="toc-text">storage.h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#storage-cpp"><span class="toc-number">4.6.2.</span> <span class="toc-text">storage.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-6"><span class="toc-number">4.6.3.</span> <span class="toc-text">介绍</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#map"><span class="toc-number">5.</span> <span class="toc-text">map</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#map-h"><span class="toc-number">5.1.</span> <span class="toc-text">map.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#map-cpp"><span class="toc-number">5.2.</span> <span class="toc-text">map.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-7"><span class="toc-number">5.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ranking"><span class="toc-number">6.</span> <span class="toc-text">ranking</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ranking-h"><span class="toc-number">6.1.</span> <span class="toc-text">ranking.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ranking-cpp"><span class="toc-number">6.2.</span> <span class="toc-text">ranking.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-8"><span class="toc-number">6.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dialog"><span class="toc-number">7.</span> <span class="toc-text">dialog</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dialog-h"><span class="toc-number">7.1.</span> <span class="toc-text">dialog.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dialog-cpp"><span class="toc-number">7.2.</span> <span class="toc-text">dialog.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-9"><span class="toc-number">7.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#droplabel"><span class="toc-number">8.</span> <span class="toc-text">droplabel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#draoplabel-h"><span class="toc-number">8.1.</span> <span class="toc-text">draoplabel.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#droplabel-cpp"><span class="toc-number">8.2.</span> <span class="toc-text">droplabel.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-10"><span class="toc-number">8.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#draglabel"><span class="toc-number">9.</span> <span class="toc-text">draglabel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#draglabel-h"><span class="toc-number">9.1.</span> <span class="toc-text">draglabel.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#draglabel-cpp"><span class="toc-number">9.2.</span> <span class="toc-text">draglabel.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-11"><span class="toc-number">9.3.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#main"><span class="toc-number">10.</span> <span class="toc-text">main</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#main-cpp"><span class="toc-number">10.1.</span> <span class="toc-text">main.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-12"><span class="toc-number">10.2.</span> <span class="toc-text">介绍</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By surtr lafael</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Ding Zhen and his animal friends are watching you</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer src="/js/light.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/sakura.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>